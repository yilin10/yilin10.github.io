<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Thoughts. Notes.">
<meta property="og:type" content="website">
<meta property="og:title" content="Parking Site">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Parking Site">
<meta property="og:description" content="Thoughts. Notes.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Yilin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Parking Site</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Parking Site</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">A castle on the cloud.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/04/super/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/04/super/" class="post-title-link" itemprop="url">Intro to Supervised Learning Notes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-04 12:13:42" itemprop="dateCreated datePublished" datetime="2020-04-04T12:13:42Z">2020-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:03:44" itemprop="dateModified" datetime="2020-04-11T12:03:44Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-What-is-Machine-Learning"><a href="#1-What-is-Machine-Learning" class="headerlink" title="1. What is Machine Learning?"></a>1. What is Machine Learning?</h2><p>Two definitions of Machine Learning are offered. </p>
<ul>
<li><p>Arthur Samuel described it as: “the field of study that gives computers the ability to learn without being explicitly programmed.” This is an older, informal definition.</p>
</li>
<li><p>Tom Mitchell provides a more modern definition: “A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E.”</p>
</li>
<li><p>Example: playing checkers.<br>E = the experience of playing many games of checkers<br>T = the task of playing checkers.<br>P = <em>the probability</em> that the program will win the next game.</p>
</li>
<li><p>In general, any machine learning problem can be assigned to one of two broad classifications: Supervised learning and Unsupervised learning.</p>
</li>
<li><p>Except from supervised learning and unsupervised, there are also Reinforcement learning, recommender systems.</p>
</li>
</ul>
<h3 id="用机器模拟人脑"><a href="#用机器模拟人脑" class="headerlink" title="用机器模拟人脑"></a>用机器模拟人脑</h3><ul>
<li>人可以描述问题，但不知道如何显式地解决问题</li>
<li>让机器得到输入和输出，寻找解决途径</li>
<li>计算机科学，可以应用在工业和基础科学上。{自动直升机，手写识别，自然语言，机器视觉，推荐算法}</li>
<li>需要足够多的数据</li>
</ul>
<h3 id="不同类型的学习算法"><a href="#不同类型的学习算法" class="headerlink" title="不同类型的学习算法"></a>不同类型的学习算法</h3><ul>
<li>作为 Tools/methods, 选择哪一种方法要看得到的数据情况（离散的数据？连续的数据）和要解决的问题（预测？分类？）</li>
<li>监督学习</li>
<li>无监督学习</li>
<li>强化学习</li>
</ul>
<h3 id="选择的问题"><a href="#选择的问题" class="headerlink" title="选择的问题"></a>选择的问题</h3><ul>
<li>需要理解算法本身，我们才能根据具体的实践问题，决定采用哪一种方法（最节省时间和精力）建立系统</li>
<li>机器可以有多种方法达到目标，但是哪一种是最优的</li>
</ul>
<h3 id="分类问题"><a href="#分类问题" class="headerlink" title="分类问题"></a>分类问题</h3><ul>
<li>Classification: Discrete valued</li>
<li>Classification(discrete) CF Regression(Continus)</li>
</ul>
<h2 id="2-What-is-supervised-learning"><a href="#2-What-is-supervised-learning" class="headerlink" title="2. What is supervised learning"></a>2. What is supervised learning</h2><ul>
<li>most important one in learning paradigm</li>
<li>an unknown function f that maps an input 𝑥 to an output  t: D = {&lt;x, t&gt;}</li>
</ul>
<h3 id="Goal-of-SL"><a href="#Goal-of-SL" class="headerlink" title="Goal of SL"></a>Goal of SL</h3><ul>
<li>Goal: is to learn a good approximation of 𝑓</li>
<li>Input variables 𝑥 are usually called features or attributes</li>
<li>Output variables 𝑡 are also called targets or labels</li>
</ul>
<h3 id="Tasks"><a href="#Tasks" class="headerlink" title="Tasks"></a>Tasks</h3><p>Classification if 𝑡 is discrete<br>Regression if 𝑡 is continuous<br>Probability estimation if 𝑡 is a probability </p>
<h3 id="Elements-in-Supervised-Learning"><a href="#Elements-in-Supervised-Learning" class="headerlink" title="Elements in Supervised Learning"></a>Elements in Supervised Learning</h3><ol>
<li>Representation<ul>
<li>Consist {linear models, instance-based, decision trees, set of rules, graphical models, neural networks, Gaussian Processes, Support vector machines, Model ensembles }</li>
</ul>
</li>
<li>Evaluation<ul>
<li>{Accuracy, precision and recall, squared error, Likelihood,<br>Posterior probability, Cost/Utility, Margin, Entropy, KL divergence}</li>
</ul>
</li>
<li>Optimization<ul>
<li>{ Combinatorial optimisation e.g.: Greedy search<br>Convex optimisation e.g.: Gradient descent<br>Constrained optimisation e.g.: Linear programming }</li>
</ul>
</li>
</ol>
<h3 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h3><ol>
<li>Training Set</li>
<li>Learning Algorithms</li>
<li>Function h(hypothesis) {Input: size of a house -&gt; h -&gt; Output:estimated price}</li>
</ol>
<h2 id="3-Unsupervised-Learning"><a href="#3-Unsupervised-Learning" class="headerlink" title="3. Unsupervised Learning"></a>3. Unsupervised Learning</h2><ul>
<li>Unsupervised learning allows us to approach problems with little or no idea what our results should look like. We can derive structure from data where we don’t necessarily know the effect of the variables.</li>
<li>We can derive this structure by clustering the data based on relationships among the variables in the data.</li>
<li>With unsupervised learning there is no feedback based on the prediction results.</li>
</ul>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h3><ul>
<li><p>Clustering: Take a collection of 1,000,000 different genes, and find a way to automatically group these genes into groups that are somehow similar or related by different variables, such as lifespan, location, roles, and so on.</p>
</li>
<li><p>Non-clustering: The “Cocktail Party Algorithm”, allows you to find structure in a chaotic environment. (i.e. identifying individual voices and music from a mesh of sounds at a cocktail party).</p>
</li>
</ul>
<h2 id="4-Model-and-Cost-Functions"><a href="#4-Model-and-Cost-Functions" class="headerlink" title="4. Model and Cost Functions"></a>4. Model and Cost Functions</h2><ol>
<li><p>Linear Regression:</p>
<ul>
<li>supervised learning:gives the “right answer” to the</li>
<li>Regression : predict real-valued output</li>
<li><ul>
<li>Classification: get discrete-valued output {eg:0,1}</li>
</ul>
</li>
</ul>
</li>
<li><p>Traning Models</p>
<ul>
<li>number of training examples</li>
<li>input variables/ features</li>
<li>output variables/ target </li>
</ul>
</li>
<li><p>Workflow</p>
<ul>
<li>Training Set -&gt;Learning Algorithms -&gt;</li>
</ul>
</li>
</ol>
<p>…</p>
<h2 id="5-Linear-Regression"><a href="#5-Linear-Regression" class="headerlink" title="5. Linear Regression"></a>5. Linear Regression</h2><h2 id="6-Linear-Classification"><a href="#6-Linear-Classification" class="headerlink" title="6. Linear Classification"></a>6. Linear Classification</h2><h2 id="7-Model-Evaluation-Selection-Ensembles"><a href="#7-Model-Evaluation-Selection-Ensembles" class="headerlink" title="7. Model Evaluation, Selection Ensembles"></a>7. Model Evaluation, Selection Ensembles</h2><h3 id="Bias-Variance"><a href="#Bias-Variance" class="headerlink" title="Bias Variance"></a>Bias Variance</h3><ol>
<li>The Bias-Variance is a framework to analyze the performance of models</li>
<li>Definition:<ul>
<li>data </li>
<li>model</li>
<li>performance</li>
<li>Thus we can decompose the expectected square error as:</li>
</ul>
</li>
<li>Model Variance,</li>
<li>Case Study: Bias Variance for K-NN</li>
</ol>
<p>我们希望模型准确，误差尽可能的小。</p>
<p>…….</p>
<h2 id="8-Reference"><a href="#8-Reference" class="headerlink" title="8. Reference"></a>8. Reference</h2><ol>
<li>Material of prof. Marcello Restelli</li>
<li>Pattern Recognition and Machine Learning, Bishop [PRML]</li>
<li>Elements of Statistical Learning, Hastie et al. [ESL]</li>
<li>Introduction to Statistical Learning, James et al. [ISL]</li>
<li>The Lack of A Priori Distinctions Between Learning Algorithms, Wolpert, 1996</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/03/pj0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/03/pj0/" class="post-title-link" itemprop="url">Boston housing Predictor</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-03 15:42:53" itemprop="dateCreated datePublished" datetime="2020-04-03T15:42:53Z">2020-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-07 12:25:11" itemprop="dateModified" datetime="2020-04-07T12:25:11Z">2020-04-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Projects/" itemprop="url" rel="index"><span itemprop="name">Projects</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>机器学习实验项目_波士顿房价预测</p>
<h2 id="0-项目背景"><a href="#0-项目背景" class="headerlink" title="0. 项目背景"></a>0. 项目背景</h2><p>这是一个几年之前的机器学习练习项目。数据来源是UCI的机器学习知识库数据集。该数据从1978年开始，共506个数据点，涵盖了马萨诸塞州波士顿郊区的房屋信息数据。</p>
<p>在此项目中，我会使用这些数据训练并测试一个可用的预测模型，并对模型的性能和预测能力进行测试。训练好的模型可以对房屋的价值进行预测，对某些工作中，应用这个模型可以帮助他们了解房屋的潜在价值，是非常实用的。</p>
<p>从学习的角度来看，做这个项目则是可以初步了解机器学习的实践方法，了解如何处理数据，并熟悉 python 和 sklearn在项目中的使用。</p>
<blockquote>
<p><strong>提示：</strong>Code 和 Markdown 区域可通过 <strong>Shift + Enter</strong> 快捷键运行。此外，Markdown可以通过双击进入编辑模式。</p>
</blockquote>
<hr>
<h2 id="1-导入数据"><a href="#1-导入数据" class="headerlink" title="1. 导入数据"></a>1. 导入数据</h2><p>本项目的数据集来自<a href="https://archive.ics.uci.edu/ml/datasets.html" target="_blank" rel="noopener">UCI机器学习知识库(数据集已下线)</a>。<br>可以看到，波士顿房屋这些数据于1978年开始统计，共506个数据点，涵盖了麻省波士顿不同郊区房屋14种特征的信息。<br>在此，首先我将针对本项目对原始数据集做以下处理：观察数据 -&gt; 移除异常值 -&gt; 思考哪些是和目标相关的特征。<br>具体处理如下：</p>
<ul>
<li>有16个<code>&#39;MEDV&#39;</code> 值为50.0的数据点被移除。 因为这些数据点包含遗失或者不明确的数值。</li>
<li>有1个数据点的 <code>&#39;RM&#39;</code> 值为8.78. 这是一个异常值，已经被移除。</li>
<li>对于本项目，房屋的<code>&#39;RM&#39;</code>， <code>&#39;LSTAT&#39;</code>，<code>&#39;PTRATIO&#39;</code>以及<code>&#39;MEDV&#39;</code>特征是必要的，其余不相关特征已经被移除。</li>
<li><code>&#39;MEDV&#39;</code>特征的值已经过必要的数学转换，可以反映35年来市场的通货膨胀效应。</li>
</ul>
<p>运行下面区域的代码后，我就可以载入波士顿房屋数据集，以及一些此项目所需的Python库。<br>我会从 csv 文件中读取到需要的数值，如果成功返回数据集的大小，则表示数据集已载入成功。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> visuals <span class="keyword">as</span> vs <span class="comment"># import supplement</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># check Python version </span></span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> version_info</span><br><span class="line"><span class="keyword">if</span> version_info.major != <span class="number">2</span> <span class="keyword">and</span> version_info.minor != <span class="number">7</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">'Please use Python 2.7'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># show result in notebook</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 载入波士顿房屋的数据集</span></span><br><span class="line">data = pd.read_csv(<span class="string">'housing.csv'</span>)</span><br><span class="line">prices = data[<span class="string">'MEDV'</span>]</span><br><span class="line">features = data.drop(<span class="string">'MEDV'</span>, axis = <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 完成</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Boston housing dataset has &#123;&#125; data points with &#123;&#125; variables each."</span>.format(*data.shape)</span><br></pre></td></tr></table></figure>

<pre><code>Boston housing dataset has 489 data points with 4 variables each.</code></pre><hr>
<h2 id="2-分析数据"><a href="#2-分析数据" class="headerlink" title="2. 分析数据"></a>2. 分析数据</h2><p>我需要继续观察目前得到的数据，以便在后续阶段能够理解对数据进行分析后得到的结果或对结果进行分析。</p>
<p>由于我的最终目标是将实现一个表现良好的房屋价值预估的模型，所以我依然需要把完整的数据集分成<strong>feature</strong>和<strong>target</strong>。</p>
<ul>
<li><strong>特征</strong>： <code>&#39;RM&#39;</code>， <code>&#39;LSTAT&#39;</code>，和 <code>&#39;PTRATIO&#39;</code></li>
<li><strong>目标变量</strong>：<code>&#39;MEDV&#39;</code>，是我希望预测的变量。</li>
</ul>
<p>我用 <code>features</code>和<code>prices</code>两个变量进行存储。</p>
<h3 id="2-1-基础统计运算"><a href="#2-1-基础统计运算" class="headerlink" title="2.1 基础统计运算"></a>2.1 基础统计运算</h3><p>我导入了<code>numpy</code> 执行计算。这些统计数据对于分析模型的预测结果非常重要的。</p>
<ul>
<li>计算<code>prices</code>中的<code>&#39;MEDV&#39;</code>的最小值、最大值、均值、中值和标准差；</li>
<li>将运算结果储存在相应的变量中。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的最小值</span></span><br><span class="line">minimum_price = np.min(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的最大值</span></span><br><span class="line">maximum_price = np.max(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的平均值</span></span><br><span class="line">mean_price = np.mean(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的中值</span></span><br><span class="line">median_price = np.median(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的标准差</span></span><br><span class="line">std_price = np.std(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：输出计算的结果</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Statistics for Boston housing dataset:\n"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Minimum price: $&#123;:,.2f&#125;"</span>.format(minimum_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Maximum price: $&#123;:,.2f&#125;"</span>.format(maximum_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Mean price: $&#123;:,.2f&#125;"</span>.format(mean_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Median price $&#123;:,.2f&#125;"</span>.format(median_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Standard deviation of prices: $&#123;:,.2f&#125;"</span>.format(std_price)</span><br></pre></td></tr></table></figure>

<pre><code>Statistics for Boston housing dataset:

Minimum price: $105,000.00
Maximum price: $1,024,800.00
Mean price: $454,342.94
Median price $438,900.00
Standard deviation of prices: $165,171.13</code></pre><h3 id="2-2-特征观察"><a href="#2-2-特征观察" class="headerlink" title="2.2 特征观察"></a>2.2 特征观察</h3><p>如前文所述，本项目中我们关注的是其中三个值:<code>&#39;RM&#39;</code>、<code>&#39;LSTAT&#39;</code> 和<code>&#39;PTRATIO&#39;</code>，对每一个数据点:</p>
<ul>
<li><code>&#39;RM&#39;</code> 是该地区中每个房屋的平均房间数量；</li>
<li><code>&#39;LSTAT&#39;</code> 是指该地区有多少百分比的业主属于是低收入阶层（有工作但收入微薄）；</li>
<li><code>&#39;PTRATIO&#39;</code> 是该地区的中学和小学里，学生和老师的数目比（<code>学生/老师</code>）。</li>
</ul>
<p><em>凭直觉，上述三个特征中对每一个来说，你认为增大该特征的数值，<code>&#39;MEDV&#39;</code>的值会是<strong>增大</strong>还是<strong>减小</strong>呢？</em></p>
<ul>
<li>RM 变大，MEDV 越大，因为房间多整体空间更大</li>
<li>LSTAT 越大，MEDV 越小，因为代表着当地经济价值比较低</li>
<li>PTRATIO 越大，MEDV 越低，因为该地区学生多教师少，教育价值降低了</li>
</ul>
<h3 id="2-2-数据分割与重排"><a href="#2-2-数据分割与重排" class="headerlink" title="2.2 数据分割与重排"></a>2.2 数据分割与重排</h3><p>接下来，我需要把波士顿房屋数据集分成训练和测试两个子集。<br>通常在这个过程中，数据也会被重排列，以消除数据集中由于顺序而产生的偏差。</p>
<p>我使用 <code>sklearn.model_selection</code> 中的 <code>train_test_split</code>， 将<code>features</code>和<code>prices</code>的数据都分成用于训练的数据子集和用于测试的数据子集。</p>
<ul>
<li>分割比例为：80%的数据用于训练，20%用于测试；</li>
<li>选定一个数值以设定 <code>train_test_split</code> 中的 <code>random_state</code> ，这会确保结果的一致性；</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提示： 导入train_test_split</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(features, prices, test_size=<span class="number">0.2</span>, random_state=<span class="number">22</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-训练及测试"><a href="#2-3-训练及测试" class="headerlink" title="2.3 训练及测试"></a>2.3 训练及测试</h3><p><em>将数据集按一定比例分为训练用的数据集和测试用的数据集对学习算法有什么好处？</em></p>
<p><em>如果用模型已经见过的数据，例如部分训练集数据进行测试，又有什么坏处？</em> 如果没有数据来对模型进行测试，会出现什么问题？</p>
<ul>
<li>将数据集按照一定比例分割，我们可以合理评估学习算法在面对未知数据时的表现效果</li>
<li>用来评价模型的数据如果不是独立于样本的，则可能评价结果是不准确的情况。我们也无法得出，这个算法是否可以应用在更广泛的情况</li>
</ul>
<hr>
<h2 id="3-模型衡量标准"><a href="#3-模型衡量标准" class="headerlink" title="3. 模型衡量标准"></a>3. 模型衡量标准</h2><p>在项目的第三步中，你需要了解必要的工具和技巧来让你的模型进行预测。用这些工具和技巧对每一个模型的表现做精确的衡量可以极大地增强你预测的信心。</p>
<h3 id="3-1-定义衡量标准"><a href="#3-1-定义衡量标准" class="headerlink" title="3.1 定义衡量标准"></a>3.1 定义衡量标准</h3><p>如果不能对模型的训练和测试的表现进行量化地评估，就很难衡量模型的好坏。一般情况下，我们可以定义一些衡量标准，这些标准可以通过对某些误差或者拟合程度的计算来得到。在这个项目中，你将通过运算<a href="http://stattrek.com/statistics/dictionary.aspx?definition=coefficient_of_determination" target="_blank" rel="noopener"><em>决定系数</em></a> R<sup>2</sup> 来量化模型的表现。模型的决定系数是回归分析中十分常用的统计信息，经常被当作衡量模型预测能力好坏的标准。</p>
<p>R<sup>2</sup>的数值范围从0至1，表示<strong>目标变量</strong>的预测值和实际值之间的相关程度平方的百分比。一个模型的R<sup>2</sup> 值为0还不如直接用<strong>平均值</strong>来预测效果好；而一个R<sup>2</sup> 值为1的模型则可以对目标变量进行完美的预测。从0至1之间的数值，则表示该模型中目标变量中有百分之多少能够用<strong>特征</strong>来解释。<em>模型也可能出现负值的R<sup>2</sup>，这种情况下模型所做预测有时会比直接计算目标变量的平均值差很多。</em></p>
<p>在下方代码的 <code>performance_metric</code> 函数中，我实现了：</p>
<ul>
<li>使用 <code>sklearn.metrics</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.r2_score.html" target="_blank" rel="noopener"><code>r2_score</code></a> 来计算 <code>y_true</code> 和 <code>y_predict</code>的R<sup>2</sup>值，作为对其表现的评判。</li>
<li>将他们的表现评分储存到<code>score</code>变量中。</li>
</ul>
<p>或（:这个并没有实现:）</p>
<ul>
<li>(可选) 不使用任何外部库，参考<a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" target="_blank" rel="noopener">决定系数的定义</a>进行计算，这也可以帮助你更好的理解决定系数在什么情况下等于0或等于1。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入r2_score</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance_metric</span><span class="params">(y_true, y_predict)</span>:</span></span><br><span class="line">    <span class="string">"""计算并返回预测值相比于预测值的分数"""</span></span><br><span class="line">    </span><br><span class="line">    score = r2_score(y_true, y_predict)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不导入任何计算决定系数的库</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance_metric2</span><span class="params">(y_true, y_predict)</span>:</span></span><br><span class="line">    <span class="string">"""计算并返回预测值相比于预测值的分数"""</span></span><br><span class="line">    </span><br><span class="line">    score = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>

<h3 id="3-2-拟合程度"><a href="#3-2-拟合程度" class="headerlink" title="3.2 拟合程度"></a>3.2 拟合程度</h3><p>假设一个数据集有五个数据且一个模型做出下列目标变量的预测：</p>
<table>
<thead>
<tr>
<th align="center">真实数值</th>
<th align="center">预测数值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3.0</td>
<td align="center">2.5</td>
</tr>
<tr>
<td align="center">-0.5</td>
<td align="center">0.0</td>
</tr>
<tr>
<td align="center">2.0</td>
<td align="center">2.1</td>
</tr>
<tr>
<td align="center">7.0</td>
<td align="center">7.8</td>
</tr>
<tr>
<td align="center">4.2</td>
<td align="center">5.3</td>
</tr>
</tbody></table>
<p><em>怎么样可以判断，这个模型已成功地描述了目标变量的变化？</em>  </p>
<p>通过运行下方的代码，我可以使用<code>performance_metric</code>函数来计算模型的决定系数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算这个模型的预测结果的决定系数</span></span><br><span class="line">score = performance_metric([<span class="number">3</span>, <span class="number">-0.5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4.2</span>], [<span class="number">2.5</span>, <span class="number">0.0</span>, <span class="number">2.1</span>, <span class="number">7.8</span>, <span class="number">5.3</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Model has a coefficient of determination, R^2, of &#123;:.3f&#125;."</span>.format(score)</span><br></pre></td></tr></table></figure>

<pre><code>Model has a coefficient of determination, R^2, of 0.923.</code></pre><ul>
<li>这个模型以及较为成功地描述了目标变量的变化。</li>
<li>因为可以看到 R^2 计算结果为 0.923 意味着数据超过90的部分能够使用模型进行特征的描述和预测</li>
</ul>
<hr>
<h2 id="4-分析模型的表现"><a href="#4-分析模型的表现" class="headerlink" title="4. 分析模型的表现"></a>4. 分析模型的表现</h2><p>在项目的第四步，可以来看一下不同参数下，模型在训练集和验证集上的表现。<br>我只是用了一个特定的算法（带剪枝的决策树），在参数选择上，这个算法只包括了选择参数 <code>&#39;max_depth&#39;</code>。<br>我会用全部训练集训练，但选择不同<code>&#39;max_depth&#39;</code> 参数，观察这个参数的变化如何影响模型的表现。<br>最后，画出模型的表现来对于分析过程十分有益，这可以让我直观地看到模型的表现。</p>
<h3 id="4-1-学习曲线"><a href="#4-1-学习曲线" class="headerlink" title="4.1 学习曲线"></a>4.1 学习曲线</h3><ul>
<li>下方区域内的代码可以输出四幅图像，他们分别表现了一个决策树模型在不同最大深度下的表现。</li>
<li>每一条曲线都直观得显示了随着训练数据量的增加，模型学习曲线的在训练集评分和验证集评分的变化。</li>
<li>评分使用决定系数R<sup>2</sup>。曲线的阴影区域代表的是该曲线的不确定性（用标准差衡量）。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据不同的训练集大小，和最大深度，生成学习曲线</span></span><br><span class="line">vs.ModelLearning(X_train, y_train)</span><br></pre></td></tr></table></figure>


<p><img src="/images/output_22_0.png" alt="png"></p>
<h3 id="4-2-对学习曲线的观察"><a href="#4-2-对学习曲线的观察" class="headerlink" title="4.2 对学习曲线的观察"></a>4.2 对学习曲线的观察</h3><p>所以从上面的图形中，我应该怎么决定合适的最大深度呢？</p>
<p>其次，随着寻来拿数据量的增加，训练集曲线的评分正在发生变化，验证集曲线也有变化。我也需要考虑数据继续增加的情况下，如何保持或者有效提升模型的表现呢？但是学习曲线看上去最终都很稳定，是不是会最终收敛到一个特定的值。</p>
<ul>
<li>我想选择 max = 3，也就是将深度设定为3.</li>
<li>从曲线的观察上来看，随着训练数据量的增加，训练集曲线评分降低了一点，但趋于稳定。</li>
<li>随着训练数据量的增加，验证集曲线迅速上升后也趋于稳定</li>
<li>如果有更多训练数据，且新训练数据分布和现有相同，模型的表现不会有什么明显提升，因为现在已经能够捕捉数据的全部特征了。</li>
</ul>
<h3 id="4-3-复杂度曲线"><a href="#4-3-复杂度曲线" class="headerlink" title="4.3 复杂度曲线"></a>4.3 复杂度曲线</h3><p>下列代码内的区域会输出一幅图像，用于展示了一个已经经过训练和验证的决策树模型在不同最大深度条件下的表现。</p>
<p>这个图形将包含两条曲线，一个是训练集的变化，一个是验证集的变化。跟<strong>学习曲线</strong>相似，阴影区域代表该曲线的不确定性，模型训练和测试部分的评分都用的 <code>performance_metric</code> 函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据不同的最大深度参数，生成复杂度曲线</span></span><br><span class="line">vs.ModelComplexity(X_train, y_train)</span><br></pre></td></tr></table></figure>


<p><img src="/images/output_26_0.png" alt="png"></p>
<h3 id="4-4-偏差（bias）与方差（variance）之间的权衡取舍"><a href="#4-4-偏差（bias）与方差（variance）之间的权衡取舍" class="headerlink" title="4.4 偏差（bias）与方差（variance）之间的权衡取舍"></a>4.4 偏差（bias）与方差（variance）之间的权衡取舍</h3><p><em>当模型以最大深度 1训练时，模型的预测是出现很大的偏差还是出现了很大的方差？当模型以最大深度10训练时，情形又如何呢？图形中的哪些特征能够支持你的结论？</em></p>
<p> 我要如何判断模型是否出现了偏差很大或者方差很大的问题？</p>
<ul>
<li>模型深度为 1 时，偏差大。</li>
<li>因为可以看到模型预测在训练集上的得分低，说明模型预测不准确。</li>
<li>而当模型深度为 10 时，方差大。</li>
<li>可以看到模型预测在训练集上的得分高，接近1，说明预测准确。但模型在训练集上表现较好，但测试集上表现差，说明面对新数据时表现不好。</li>
</ul>
<h3 id="4-5-最优模型的猜测"><a href="#4-5-最优模型的猜测" class="headerlink" title="4.5 最优模型的猜测"></a>4.5 最优模型的猜测</h3><p>我应该选择哪一个最大深度，才能对未来（未知）的数据进行预测。</p>
<ul>
<li>按照图 5 来看可以选择深度为 6 的模型。</li>
<li>个人认为，深度为 4 时，方差最小，但偏差仅仅超过0.8。</li>
<li>随着深度增加，偏差仍在迅速缩小，而在 6 之后，偏差开始趋于稳定，处在0.9左右。</li>
<li>此时方差看上去增大了0.1左右，可以接受。</li>
</ul>
<hr>
<h2 id="5-选择最优参数"><a href="#5-选择最优参数" class="headerlink" title="5. 选择最优参数"></a>5. 选择最优参数</h2><h3 id="5-1-网格搜索（Grid-Search）"><a href="#5-1-网格搜索（Grid-Search）" class="headerlink" title="5.1 网格搜索（Grid Search）"></a>5.1 网格搜索（Grid Search）</h3><p><em>什么是网格搜索法？如何用它来优化模型？</em></p>
<ul>
<li>网格搜索，是一种系统地遍历多种参数组合，通过交叉验证确定最佳效果参数的方法</li>
<li>使用网格搜索优化模型，可以对不同参数组合进行评估，得到最合适的参数组合，优化模型</li>
</ul>
<h3 id="5-2-交叉验证"><a href="#5-2-交叉验证" class="headerlink" title="5.2 交叉验证"></a>5.2 交叉验证</h3><ul>
<li>什么是K折交叉验证法（k-fold cross-validation）？</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener">GridSearchCV</a>是如何结合交叉验证来完成对最佳参数组合的选择的？</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener">GridSearchCV</a>中的<code>&#39;cv_results_&#39;</code>属性能告诉我们什么？</li>
<li>网格搜索时如果不使用交叉验证会有什么问题？交叉验证又是如何解决这个问题的？</li>
</ul>
<p>在下面 fit_model函数最后加入 <code>print pd.DataFrame(grid.cv_results_)</code> 可以查看更多信息。</p>
<ol>
<li><p>什么是K折交叉验证法（k-fold cross-validation）？</p>
<ul>
<li>K折交叉验证，是将训练数据（验证集）平分到 k 个容器。在每次实验时，选择其中 1 个容器中的数据作为验证集，其他（k-1）个容器作为训练集。</li>
<li>继续训练模型，并进行验证。</li>
<li>交叉验证会在过程中进行 k 次实验，然后取得 k 次实验测试结果的平均值。</li>
</ul>
</li>
<li><p>网格搜索如何结合交叉验证完成最佳参数选择？</p>
<ul>
<li>这种方法中我们对每 1 个参数组合进行 1 次 K 折较差验证，得到平均分数。</li>
<li>一般选择均分最高的参数组合作为最优参数，但如果品分标准是loss，会选择评分最低的参数组合。</li>
</ul>
</li>
<li><p>cv_results_属性代表什么？</p>
<ul>
<li>cv_results_可以用来来获得最优参数组合</li>
<li>它返回了一个字典，其中记录了每一组网格参数每一次实验时的结果，如时间、评估值、其他统计信息</li>
</ul>
</li>
<li><p>网格搜索时如果不使用交叉验证会有什么问题？交叉验证又是如何解决这个问题的？</p>
<ul>
<li>网格搜索不使用交叉验证时所花费的训练时间更短，但模型参数并不是最优；</li>
<li>交叉验证进行更多次的试验，使用了全部训练集，能够对每一个参数组合得出更准确的评分。</li>
</ul>
</li>
</ol>
<h3 id="5-3-决策树算法"><a href="#5-3-决策树算法" class="headerlink" title="5.3 决策树算法"></a>5.3 决策树算法</h3><p>下面，我会使用<strong>决策树算法</strong>训练一个模型。</p>
<p>为了得出的是一个最优模型，我需要使用网格搜索法训练模型，以找到最佳的 <code>&#39;max_depth&#39;</code> 参数。我可以把<code>&#39;max_depth&#39;</code> 参数理解为决策树算法在做出预测前，可以允许的对数据提出问题的数量。而决策树也是<strong>监督学习算法</strong>中的一种。</p>
<p>在下方 <code>fit_model</code> 函数中，我进行了如下的定义：</p>
<ol>
<li><strong>定义 <code>&#39;cross_validator&#39;</code> 变量</strong>: 使用 <code>sklearn.model_selection</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" target="_blank" rel="noopener"><code>KFold</code></a> 创建一个交叉验证生成器对象;</li>
<li><strong>定义 <code>&#39;regressor&#39;</code> 变量</strong>: 使用  <code>sklearn.tree</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html" target="_blank" rel="noopener"><code>DecisionTreeRegressor</code></a> 创建一个决策树的回归函数;</li>
<li><strong>定义 <code>&#39;params&#39;</code> 变量</strong>: 为 <code>&#39;max_depth&#39;</code> 参数创造一个字典，它的值是从1至10的数组;</li>
<li><strong>定义 <code>&#39;scoring_fnc&#39;</code> 变量</strong>: 使用 <code>sklearn.metrics</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html" target="_blank" rel="noopener"><code>make_scorer</code></a>  创建一个评分函数；<br>将 <code>‘performance_metric’</code> 作为参数传至这个函数中；</li>
<li><strong>定义 <code>&#39;grid&#39;</code> 变量</strong>: 使用 <code>sklearn.model_selection</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener"><code>GridSearchCV</code></a> 创建一个网格搜索对象；将变量<code>&#39;regressor&#39;</code>, <code>&#39;params&#39;</code>, <code>&#39;scoring_fnc&#39;</code>和 <code>&#39;cross_validator&#39;</code> 作为参数传至这个对象构造函数中；</li>
</ol>
<p>关于python函数的默认参数定义和传递，可以参考的资料是，这个MIT课程的<a href="http://cn-static.udacity.com/mlnd/videos/MIT600XXT114-V004200_DTH.mp4" target="_blank" rel="noopener">视频</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提示: 导入 'KFold' 'DecisionTreeRegressor' 'make_scorer' 'GridSearchCV' </span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold,GridSearchCV</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> make_scorer</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_model</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">""" 基于输入数据 [X,y]，利于网格搜索找到最优的决策树模型"""</span></span><br><span class="line">    </span><br><span class="line">    cross_validator = KFold(n_splits=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    regressor =  DecisionTreeRegressor()</span><br><span class="line"></span><br><span class="line">    params = &#123;<span class="string">'max_depth'</span>:range(<span class="number">1</span>,<span class="number">11</span>)&#125;</span><br><span class="line"></span><br><span class="line">    scoring_fnc = make_scorer(performance_metric)</span><br><span class="line"></span><br><span class="line">    grid = GridSearchCV(regressor, params, scoring=scoring_fnc,cv=cross_validator)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 基于输入数据 [X,y]，进行网格搜索</span></span><br><span class="line">    grid = grid.fit(X, y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回网格搜索后的最优模型</span></span><br><span class="line">    <span class="keyword">return</span> grid.best_estimator_</span><br></pre></td></tr></table></figure>

<h3 id="5-4-训练最优模型（-没有实现）"><a href="#5-4-训练最优模型（-没有实现）" class="headerlink" title="5.4 训练最优模型（*没有实现）"></a>5.4 训练最优模型（*没有实现）</h3><p>另外一种方法是在下方 <code>fit_model</code> 函数中：</p>
<ul>
<li>遍历参数<code>‘max_depth’</code>的可选值 1～10，构造对应模型</li>
<li>计算当前模型的交叉验证分数</li>
<li>返回最优交叉验证分数对应的模型</li>
</ul>
<p>但这一个方法还没有完成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Not finished!</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">不允许使用 DecisionTreeRegressor 以外的任何 sklearn 库</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">提示: 你可能需要实现下面的 cross_val_score 函数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def cross_val_score(estimator, X, y, scoring = performance_metric, cv=3):</span></span><br><span class="line"><span class="string">    """ 返回每组交叉验证的模型分数的数组 """</span></span><br><span class="line"><span class="string">    scores = [0,0,0]</span></span><br><span class="line"><span class="string">    return scores</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_model2</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">""" 基于输入数据 [X,y]，利于网格搜索找到最优的决策树模型"""</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#最优交叉验证分数对应的最优模型</span></span><br><span class="line">    best_estimator = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> best_estimator</span><br></pre></td></tr></table></figure>

<h3 id="5-5-最优模型"><a href="#5-5-最优模型" class="headerlink" title="5.5 最优模型"></a>5.5 最优模型</h3><p><em>最优模型的最大深度（maximum depth）是多少？</em></p>
<p>通过下面的代码，我能够将决策树回归函数代入训练数据的集合，以得到最优化的模型。并得到最大深度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于训练数据，获得最优模型</span></span><br><span class="line">optimal_reg = fit_model(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出最优模型的 'max_depth' 参数</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Parameter 'max_depth' is &#123;&#125; for the optimal model."</span>.format(optimal_reg.get_params()[<span class="string">'max_depth'</span>])</span><br></pre></td></tr></table></figure>

<pre><code>Parameter &apos;max_depth&apos; is 4 for the optimal model.</code></pre><p>可以看到，此时的最大深度为4，和我开始目测的不同。</p>
<h2 id="6-做出预测"><a href="#6-做出预测" class="headerlink" title="6. 做出预测"></a>6. 做出预测</h2><p>当我们用数据训练出一个模型，它现在就可用于对新的数据进行预测。在决策树回归函数中，模型已经学会对新输入的数据<em>提问</em>，并返回对<strong>目标变量</strong>的预测值。你可以用这个预测来获取数据未知目标变量的信息，这些数据必须是不包含在训练数据之内的。</p>
<h3 id="6-1-预测销售价格"><a href="#6-1-预测销售价格" class="headerlink" title="6.1 预测销售价格"></a>6.1 预测销售价格</h3><p>接下来由于模型已经得到了，我需要开始应用这个模型处理一些问题。</p>
<p>假设我是一个在波士顿地区的房屋经纪人，我可以使用此模型以帮助你的客户评估他们想出售的房屋。</p>
<p>假设你已经从你的三个客户收集到以下的资讯:</p>
<table>
<thead>
<tr>
<th align="center">特征</th>
<th align="center">客戶 1</th>
<th align="center">客戶 2</th>
<th align="center">客戶 3</th>
</tr>
</thead>
<tbody><tr>
<td align="center">房屋内房间总数</td>
<td align="center">5 间房间</td>
<td align="center">4 间房间</td>
<td align="center">8 间房间</td>
</tr>
<tr>
<td align="center">社区贫困指数（％被认为是贫困阶层）</td>
<td align="center">17%</td>
<td align="center">32%</td>
<td align="center">3%</td>
</tr>
<tr>
<td align="center">邻近学校的学生-老师比例</td>
<td align="center">15：1</td>
<td align="center">22：1</td>
<td align="center">12：1</td>
</tr>
</tbody></table>
<p><em>那么接下来，我需要给每位客户的房屋销售的价格进行建议？并通过房屋特征的数值提供对于价格的合理判断。</em> </p>
<p>运行下列的代码区域，我就可以使用优化的模型来为每位客户的房屋价值做出预测。并结合我在第一步中数据分析的阶段，计算出来的部分统计信息来辅助证明我的模型是否正确。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成三个客户的数据</span></span><br><span class="line">client_data = [[<span class="number">5</span>, <span class="number">17</span>, <span class="number">15</span>], <span class="comment"># 客户 1</span></span><br><span class="line">               [<span class="number">4</span>, <span class="number">32</span>, <span class="number">22</span>], <span class="comment"># 客户 2</span></span><br><span class="line">               [<span class="number">8</span>, <span class="number">3</span>, <span class="number">12</span>]]  <span class="comment"># 客户 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行预测</span></span><br><span class="line">predicted_price = optimal_reg.predict(client_data)</span><br><span class="line"><span class="keyword">for</span> i, price <span class="keyword">in</span> enumerate(predicted_price):</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Predicted selling price for Client &#123;&#125;'s home: $&#123;:,.2f&#125;"</span>.format(i+<span class="number">1</span>, price)</span><br></pre></td></tr></table></figure>

<pre><code>Predicted selling price for Client 1&apos;s home: $409,100.00
Predicted selling price for Client 2&apos;s home: $285,600.00
Predicted selling price for Client 3&apos;s home: $957,218.18</code></pre><ul>
<li><p>预测价值为409100、285600、957218 美元。</p>
</li>
<li><p>从房屋特征来看，房屋质量的高中低档水平应该是 客户 3 （高档）&gt; 客户 1 （中档）&gt; 客户 2（低档） 。</p>
</li>
<li><p>从统计数据来看，客户 1 的房屋价值处在 Min 与 Max 之间，接近均价和中位数。客户 2 的房屋价值较低，只稍微比 Min 高一点。客户 3 的房屋价值较高，接近 Max 价格。符合房屋特征的判断，因此预测还是是比较合理的。</p>
</li>
</ul>
<h3 id="6-2-使用模型进行预测"><a href="#6-2-使用模型进行预测" class="headerlink" title="6.2 使用模型进行预测"></a>6.2 使用模型进行预测</h3><p>我对三个客户的房子的售价进行了预测。接下来，我会使用我的最优模型在整个测试数据上进行预测, 并计算相对于目标变量的决定系数 R<sup>2</sup>的值**。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 提示：你可能需要用到 X_test, y_test, optimal_reg, performance_metric</span></span><br><span class="line"><span class="comment"># 提示：你可能需要参考问题10的代码进行预测</span></span><br><span class="line"><span class="comment"># 提示：你可能需要参考问题3的代码来计算R^2的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line">r2 = r2_score(y_test, optimal_reg.predict(X_test))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Optimal model has R^2 score &#123;:,.2f&#125; on test data"</span>.format(r2)</span><br></pre></td></tr></table></figure>

<pre><code>Optimal model has R^2 score 0.78 on test data</code></pre><h3 id="6-3-分析决定系数"><a href="#6-3-分析决定系数" class="headerlink" title="6.3 分析决定系数"></a>6.3 分析决定系数</h3><p>刚刚计算了最优模型在测试集上的决定系数，但我应该如何评价这个结果？</p>
<p>结果为 0.78 结果不算太好，但也可以进行基本的房屋价值预测了。</p>
<h3 id="6-4-模型的健壮性"><a href="#6-4-模型的健壮性" class="headerlink" title="6.4 模型的健壮性"></a>6.4 模型的健壮性</h3><p>一个最优的模型不一定是一个健壮模型。有的时候模型会过于复杂或者过于简单，以致于难以泛化新增添的数据；有的时候模型采用的学习算法并不适用于特定的数据结构；有的时候样本本身可能有太多噪点或样本过少，使得模型无法准确地预测目标变量。这些情况下我们会说模型是欠拟合的。</p>
<p>模型是否足够健壮来保证预测的一致性？</p>
<p>下面，我会采用不同的训练和测试集执行 <code>fit_model</code> 函数10次。</p>
<p>对一个特定的客户来说，预测是如何随训练数据的变化而变化的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释掉 fit_model 函数里的所有 print 语句</span></span><br><span class="line">vs.PredictTrials(features, prices, fit_model, client_data)</span><br></pre></td></tr></table></figure>

<pre><code>Trial 1: $391,183.33
Trial 2: $411,417.39
Trial 3: $415,800.00
Trial 4: $420,622.22
Trial 5: $413,334.78
Trial 6: $411,931.58
Trial 7: $399,663.16
Trial 8: $407,232.00
Trial 9: $402,531.82
Trial 10: $413,700.00

Range in prices: $29,438.89</code></pre><ul>
<li>可以从上述的结果中看到，模型还是没有太不健壮，保持了一定的稳定性。模型随着数据集的变化，最大变化差值为 29438.89 ，约为 7.5% 左右的幅度。</li>
</ul>
<h3 id="6-5-结果分析"><a href="#6-5-结果分析" class="headerlink" title="6.5 结果分析"></a>6.5 结果分析</h3><p>从结果来看，我建构的模型能否在现实世界中使用?</p>
<ul>
<li>1978年所采集的数据，在已考虑通货膨胀的前提下，在今天是否仍然适用？</li>
<li>数据中呈现的特征是否足够描述一个房屋？</li>
<li>在波士顿这样的大都市采集的数据，能否应用在其它乡镇地区</li>
<li>你觉得仅仅凭房屋所在社区的环境来判断房屋价值合理吗</li>
</ul>
<p>不同时代经济发展状况不同，人们的经济观念也不同，房屋价值的模型会随之改变。因此会在今天并不适用。<br>数据中呈现的数据还是比较简化的，没有包括房屋的采光、房体结构、社区成熟度、交通便利性等因素。<br>波士顿城市数据，应该不能应用在乡镇地区。一级城市、二级城市、偏远乡村的整体房屋价值均值相差肯定很大，会让数据集呈现异常，影响模型对特征的判断。<br>不合理，社区环境还不够全面</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/01/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/01/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-01 08:00:01" itemprop="dateCreated datePublished" datetime="2020-04-01T08:00:01Z">2020-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-07 12:23:26" itemprop="dateModified" datetime="2020-04-07T12:23:26Z">2020-04-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Other/" itemprop="url" rel="index"><span itemprop="name">Other</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/24/scrabble/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/24/scrabble/" class="post-title-link" itemprop="url">拼字游戏Scrabble：人类cf计算机</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-07-24 21:18:27" itemprop="dateCreated datePublished" datetime="2018-07-24T21:18:27Z">2018-07-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:28:56" itemprop="dateModified" datetime="2020-04-11T12:28:56Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h3><p>本项目中包括两个版本的简单拼字文字游戏。</p>
<p>前一版本中，我们让由人类玩家参与游戏过程，后者则交给计算机来执行设定的游戏策略。</p>
<p>这种拼字游戏的完成版就是常在报纸上见到的填字游戏，欧美国家的游客在旅途上似乎非常喜欢这个游戏。</p>
<h3 id="Version1：人类玩家版本"><a href="#Version1：人类玩家版本" class="headerlink" title="Version1：人类玩家版本"></a>Version1：人类玩家版本</h3><p>编程策略上，我们将大的模块分解成功能清晰且小的函数，这将便于测试和调试。</p>
<p>首先我们可以完成辅助性的函数模块：</p>
<h3 id="辅助性模块"><a href="#辅助性模块" class="headerlink" title="辅助性模块"></a>辅助性模块</h3><ol>
<li>loadWords()</li>
<li>getFrequencyDict(sequence)</li>
</ol>
<p>它们分别用来读取词库、将列表中的字母按照 <strong>字母</strong> 和 <strong>频次</strong> 进行输出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadWords</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Returns a list of valid words. Words are strings of lowercase letters.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Depending on the size of the word list, this function may</span></span><br><span class="line"><span class="string">    take a while to finish.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    print(<span class="string">"Loading word list from file..."</span>)</span><br><span class="line">    <span class="comment"># inFile: file</span></span><br><span class="line">    inFile = open(WORDLIST_FILENAME, <span class="string">'r'</span>)</span><br><span class="line">    <span class="comment"># wordList: list of strings</span></span><br><span class="line">    wordList = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> inFile:</span><br><span class="line">        wordList.append(line.strip().lower())</span><br><span class="line">    print(<span class="string">"  "</span>, len(wordList), <span class="string">"words loaded."</span>)</span><br><span class="line">    <span class="keyword">return</span> wordList</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFrequencyDict</span><span class="params">(sequence)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Returns a dictionary where the keys are elements of the sequence</span></span><br><span class="line"><span class="string">    and the values are integer counts, for the number of times that</span></span><br><span class="line"><span class="string">    an element is repeated in the sequence.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    sequence: string or list</span></span><br><span class="line"><span class="string">    return: dictionary</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># freqs: dictionary (element_type -&gt; int)</span></span><br><span class="line">    freq = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> sequence:</span><br><span class="line">        freq[x] = freq.get(x,<span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> freq</span><br></pre></td></tr></table></figure>

<h3 id="基本函数"><a href="#基本函数" class="headerlink" title="基本函数"></a>基本函数</h3><h4 id="getWordScore-word-n-，用于计算在本次拼字尝试中的得分"><a href="#getWordScore-word-n-，用于计算在本次拼字尝试中的得分" class="headerlink" title="getWordScore(word, n) ，用于计算在本次拼字尝试中的得分"></a>getWordScore(word, n) ，用于计算在本次拼字尝试中的得分</h4><p>计算得分的规则为：<br>score = 总和（字母分值）* 长度 + bonus（50）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getWordScore</span><span class="params">(word, n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Returns the score for a word. Assumes the word is a valid word.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The score for a word is the sum of the points for letters in the</span></span><br><span class="line"><span class="string">    word, multiplied by the length of the word, PLUS 50 points if all n</span></span><br><span class="line"><span class="string">    letters are used on the first turn.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Letters are scored as in Scrabble; A is worth 1, B is worth 3, C is</span></span><br><span class="line"><span class="string">    worth 3, D is worth 2, E is worth 1, and so on (see SCRABBLE_LETTER_VALUES)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    word: string (lowercase letters)</span></span><br><span class="line"><span class="string">    n: integer (HAND_SIZE; i.e., hand size required for additional points)</span></span><br><span class="line"><span class="string">    returns: int &gt;= 0</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    score = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> elm <span class="keyword">in</span> word:</span><br><span class="line">        score += SCRABBLE_LETTER_VALUES[elm]</span><br><span class="line">    score *= len(word)</span><br><span class="line">    <span class="keyword">if</span> len(word) == n:</span><br><span class="line">        score += <span class="number">50</span></span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>

<h4 id="displayHand-hand-，对当前拼字尝试在控制台上进行输出，便于游戏玩家查看"><a href="#displayHand-hand-，对当前拼字尝试在控制台上进行输出，便于游戏玩家查看" class="headerlink" title="displayHand(hand)，对当前拼字尝试在控制台上进行输出，便于游戏玩家查看"></a>displayHand(hand)，对当前拼字尝试在控制台上进行输出，便于游戏玩家查看</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">displayHand</span><span class="params">(hand)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Displays the letters currently in the hand.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    For example:</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; displayHand(&#123;'a':1, 'x':2, 'l':3, 'e':1&#125;)</span></span><br><span class="line"><span class="string">    Should print out something like:</span></span><br><span class="line"><span class="string">       a x x l l l e</span></span><br><span class="line"><span class="string">    The order of the letters is unimportant.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    hand: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> hand.keys():</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(hand[letter]):</span><br><span class="line">             print(letter,end=<span class="string">" "</span>)       <span class="comment"># print all on the same line</span></span><br><span class="line">    print()                             <span class="comment"># print an empty line</span></span><br></pre></td></tr></table></figure>

<h4 id="dealHand-n-随机生成新一轮拼字的题目，即乱序的字母，需要包含一定的元音"><a href="#dealHand-n-随机生成新一轮拼字的题目，即乱序的字母，需要包含一定的元音" class="headerlink" title="dealHand(n) 随机生成新一轮拼字的题目，即乱序的字母，需要包含一定的元音"></a>dealHand(n) 随机生成新一轮拼字的题目，即乱序的字母，需要包含一定的元音</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dealHand</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Returns a random hand containing n lowercase letters.</span></span><br><span class="line"><span class="string">    At least n/3 the letters in the hand should be VOWELS.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Hands are represented as dictionaries. The keys are</span></span><br><span class="line"><span class="string">    letters and the values are the number of times the</span></span><br><span class="line"><span class="string">    particular letter is repeated in that hand.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    n: int &gt;= 0</span></span><br><span class="line"><span class="string">    returns: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    hand=&#123;&#125;</span><br><span class="line">    numVowels = n // <span class="number">3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numVowels):</span><br><span class="line">        x = VOWELS[random.randrange(<span class="number">0</span>,len(VOWELS))]</span><br><span class="line">        hand[x] = hand.get(x, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numVowels, n):    </span><br><span class="line">        x = CONSONANTS[random.randrange(<span class="number">0</span>,len(CONSONANTS))]</span><br><span class="line">        hand[x] = hand.get(x, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> hand</span><br></pre></td></tr></table></figure>

<h4 id="updateHand-hand-word"><a href="#updateHand-hand-word" class="headerlink" title="updateHand(hand, word)"></a>updateHand(hand, word)</h4><p>用于在下一轮拼字猜测之前，删除上一轮已被成功使用过的字母。遗留在字典中的字母可以输出，以提示用户</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">updateHand</span><span class="params">(hand, word)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Assumes that 'hand' has all the letters in word.</span></span><br><span class="line"><span class="string">    In other words, this assumes that however many times</span></span><br><span class="line"><span class="string">    a letter appears in 'word', 'hand' has at least as</span></span><br><span class="line"><span class="string">    many of that letter in it. </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Updates the hand: uses up the letters in the given word</span></span><br><span class="line"><span class="string">    and returns the new hand, without those letters in it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Has no side effects: does not modify hand.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    word: string</span></span><br><span class="line"><span class="string">    hand: dictionary (string -&gt; int)    </span></span><br><span class="line"><span class="string">    returns: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># TO DO ... &lt;-- Remove this comment when you code this function</span></span><br><span class="line">    new = hand.copy()</span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> word:</span><br><span class="line">        new[letter] -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> new</span><br></pre></td></tr></table></figure>

<h4 id="isValidWord-word-hand-wordList"><a href="#isValidWord-word-hand-wordList" class="headerlink" title="isValidWord(word, hand, wordList)"></a>isValidWord(word, hand, wordList)</h4><p>验证拼字时的猜测是否能构成有效的单词。 预先以及提供了一份有效单词的列表，存储在wordList中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isValidWord</span><span class="params">(word, hand, wordList)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Returns True if word is in the wordList and is entirely</span></span><br><span class="line"><span class="string">    composed of letters in the hand. Otherwise, returns False.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Does not mutate hand or wordList.</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">    word: string</span></span><br><span class="line"><span class="string">    hand: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    wordList: list of lowercase strings</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># TO DO ... &lt;-- Remove this comment when you code this function</span></span><br><span class="line">    <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> wordList:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> word:</span><br><span class="line">        <span class="keyword">if</span> hand.get(a,<span class="number">0</span>) &lt; getFrequencyDict(word)[a]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p>这个函数也可以直接用一行写完。但似乎在可读性和效率上，也没有一行写完的必要？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2rd solution : one line </span></span><br><span class="line"><span class="comment"># return word in wordList and all(hand.get(a, 0) &gt;= b for a, b in getFrequencyDict(word).items())</span></span><br></pre></td></tr></table></figure>

<h4 id="calculateHandlen-hand"><a href="#calculateHandlen-hand" class="headerlink" title="calculateHandlen(hand)"></a>calculateHandlen(hand)</h4><p>计算拼字猜测中，总计包含的字母数量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculateHandlen</span><span class="params">(hand)</span>:</span></span><br><span class="line">    <span class="string">""" </span></span><br><span class="line"><span class="string">    Returns the length (number of letters) in the current hand.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    hand: dictionary (string-&gt; int)</span></span><br><span class="line"><span class="string">    returns: integer</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># TO DO... &lt;-- Remove this comment when you code this function</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(hand.keys())):</span><br><span class="line">        sum += list(hand.values())[i]</span><br><span class="line">    <span class="keyword">return</span> sum</span><br></pre></td></tr></table></figure>

<p><strong>这个比较适合一行写完</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2rd solution:</span></span><br><span class="line"><span class="comment"># return sum(x for x in hand.values())</span></span><br></pre></td></tr></table></figure>

<h3 id="进入正题"><a href="#进入正题" class="headerlink" title="进入正题"></a>进入正题</h3><h4 id="playHand-hand-wordList-n"><a href="#playHand-hand-wordList-n" class="headerlink" title="playHand(hand, wordList, n)"></a>playHand(hand, wordList, n)</h4><p>包含：</p>
<ul>
<li>一轮猜测中所需要处理的交互（用户输入、控制台输出）</li>
<li>控制流程</li>
<li>计算得分</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">playHand</span><span class="params">(hand, wordList, n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Allows the user to play the given hand, as follows:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    * The hand is displayed.</span></span><br><span class="line"><span class="string">    * The user may input a word or a single period (the string ".") </span></span><br><span class="line"><span class="string">      to indicate they're done playing</span></span><br><span class="line"><span class="string">    * Invalid words are rejected, and a message is displayed asking</span></span><br><span class="line"><span class="string">      the user to choose another word until they enter a valid word or "."</span></span><br><span class="line"><span class="string">    * When a valid word is entered, it uses up letters from the hand.</span></span><br><span class="line"><span class="string">    * After every valid word: the score for that word is displayed,</span></span><br><span class="line"><span class="string">      the remaining letters in the hand are displayed, and the user</span></span><br><span class="line"><span class="string">      is asked to input another word.</span></span><br><span class="line"><span class="string">    * The sum of the word scores is displayed when the hand finishes.</span></span><br><span class="line"><span class="string">    * The hand finishes when there are no more unused letters or the user</span></span><br><span class="line"><span class="string">      inputs a "."</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      hand: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">      wordList: list of lowercase strings</span></span><br><span class="line"><span class="string">      n: integer (HAND_SIZE; i.e., hand size required for additional points)</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    score = <span class="number">0</span></span><br><span class="line">    <span class="comment"># As long as there are still letters left in the hand:</span></span><br><span class="line">    <span class="keyword">while</span> calculateHandlen(hand) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Display the hand</span></span><br><span class="line">        print(<span class="string">"Current Hand:"</span>,end = <span class="string">' '</span>)</span><br><span class="line">        displayHand(hand)</span><br><span class="line">        <span class="comment"># Ask user for input</span></span><br><span class="line">        newin = input(<span class="string">"Enter word, or a '.' to indicate that you are finished: "</span>)</span><br><span class="line">        <span class="comment"># If the input is a single period:</span></span><br><span class="line">        <span class="keyword">if</span> newin == <span class="string">"."</span>:</span><br><span class="line">            <span class="comment"># End the game (break out of the loop)</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># Otherwise (the input is not a single period):</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># If the word is not valid:</span></span><br><span class="line">            <span class="keyword">if</span> isValidWord(newin, hand, wordList) == <span class="literal">False</span>:</span><br><span class="line">                <span class="comment"># Reject invalid word (print a message followed by a blank line)</span></span><br><span class="line">                print(<span class="string">"Invalid word, please try again."</span>)</span><br><span class="line">            <span class="comment"># Otherwise (the word is valid):</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># Tell the user how many points the word earned, and the updated total score, in one line followed by a blank line</span></span><br><span class="line">                current_score = getWordScore(newin, n)</span><br><span class="line">                score += current_score</span><br><span class="line">                print(newin + <span class="string">" earned "</span> + str</span><br><span class="line">                      (current_score) + <span class="string">" points. Total: "</span> + str(score))</span><br><span class="line">                <span class="comment"># Update the hand </span></span><br><span class="line">                hand = updateHand(hand, newin)</span><br><span class="line">    <span class="comment"># Game is over (user entered a '.' or ran out of letters), so tell user the total score</span></span><br><span class="line">    <span class="keyword">if</span> newin == <span class="string">'.'</span>:</span><br><span class="line">        print(<span class="string">'Goodbye! Total score:'</span>, score, <span class="string">'points.'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'Run out of letters. Total score:'</span>, score, <span class="string">'points.'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="playGame-wordList-正式游戏开始"><a href="#playGame-wordList-正式游戏开始" class="headerlink" title="playGame(wordList) 正式游戏开始"></a>playGame(wordList) 正式游戏开始</h4><p>主要包含一些用户与计算机的交互操作：</p>
<ul>
<li>继续游戏？</li>
<li>重新开始？</li>
<li>结束游戏？</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">playGame</span><span class="params">(wordList)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Allow the user to play an arbitrary number of hands.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    1) Asks the user to input 'n' or 'r' or 'e'.</span></span><br><span class="line"><span class="string">      * If the user inputs 'n', let the user play a new (random) hand.</span></span><br><span class="line"><span class="string">      * If the user inputs 'r', let the user play the last hand again.</span></span><br><span class="line"><span class="string">      * If the user inputs 'e', exit the game.</span></span><br><span class="line"><span class="string">      * If the user inputs anything else, tell them their input was invalid.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    2) When done playing the hand, repeat from step 1    </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    n = HAND_SIZE</span><br><span class="line">    hand= &#123;&#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        choice = input(<span class="string">"Enter n to deal a new hand, r to replay the last hand, or e to end game: "</span>)</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="string">'r'</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> hand:</span><br><span class="line">                print(<span class="string">'You have not played a hand yet. Please play a new hand first!'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                playHand(hand, wordList, n)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">'n'</span>:</span><br><span class="line">            hand = dealHand(n)</span><br><span class="line">            playHand(hand, wordList, n)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">'e'</span>:</span><br><span class="line">             <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"Invalid command."</span>)</span><br></pre></td></tr></table></figure>

<h3 id="游戏主程序"><a href="#游戏主程序" class="headerlink" title="游戏主程序"></a>游戏主程序</h3><p>导入需要的库、进行全局变量的定义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">VOWELS = <span class="string">'aeiou'</span></span><br><span class="line">CONSONANTS = <span class="string">'bcdfghjklmnpqrstvwxyz'</span></span><br><span class="line">HAND_SIZE = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">SCRABBLE_LETTER_VALUES = &#123;</span><br><span class="line">    <span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">3</span>, <span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">2</span>, <span class="string">'e'</span>: <span class="number">1</span>, <span class="string">'f'</span>: <span class="number">4</span>, <span class="string">'g'</span>: <span class="number">2</span>, <span class="string">'h'</span>: <span class="number">4</span>, <span class="string">'i'</span>: <span class="number">1</span>, <span class="string">'j'</span>: <span class="number">8</span>, <span class="string">'k'</span>: <span class="number">5</span>, <span class="string">'l'</span>: <span class="number">1</span>, <span class="string">'m'</span>: <span class="number">3</span>, <span class="string">'n'</span>: <span class="number">1</span>, <span class="string">'o'</span>: <span class="number">1</span>, <span class="string">'p'</span>: <span class="number">3</span>, <span class="string">'q'</span>: <span class="number">10</span>, <span class="string">'r'</span>: <span class="number">1</span>, <span class="string">'s'</span>: <span class="number">1</span>, <span class="string">'t'</span>: <span class="number">1</span>, <span class="string">'u'</span>: <span class="number">1</span>, <span class="string">'v'</span>: <span class="number">4</span>, <span class="string">'w'</span>: <span class="number">4</span>, <span class="string">'x'</span>: <span class="number">8</span>, <span class="string">'y'</span>: <span class="number">4</span>, <span class="string">'z'</span>: <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">WORDLIST_FILENAME = <span class="string">"words.txt"</span></span><br></pre></td></tr></table></figure>

<h4 id="进行程序的执行"><a href="#进行程序的执行" class="headerlink" title="进行程序的执行"></a>进行程序的执行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Build data structures used for entire session and play game</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    wordList = loadWords()</span><br><span class="line">    playGame(wordList)</span><br></pre></td></tr></table></figure>

<pre><code>Loading word list from file...
   83667 words loaded.
Enter n to deal a new hand, r to replay the last hand, or e to end game: e</code></pre><h4 id="测试样例"><a href="#测试样例" class="headerlink" title="测试样例"></a>测试样例</h4><p>已通过单元测试和整体测试，篇幅关系不再赘述</p>
<h3 id="Version2-：计算机玩家版本"><a href="#Version2-：计算机玩家版本" class="headerlink" title="Version2 ：计算机玩家版本"></a>Version2 ：计算机玩家版本</h3><p>计算机版本中，辅助性函数和基本函数没有改变，仅在游戏交互和流程上多了一些内容。</p>
<p>用户可以选择是否由计算机执行拼字操作。</p>
<p>由此，我们能够观察到最终策略导致的得分差异。</p>
<h4 id="导入需要的模块"><a href="#导入需要的模块" class="headerlink" title="导入需要的模块"></a>导入需要的模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ps4a <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure>

<h4 id="基本策略部分"><a href="#基本策略部分" class="headerlink" title="基本策略部分"></a>基本策略部分</h4><p>版本 2 中 ，我们还需要在版本 1 的基础上写全新的计算机处理的基本策略部分。</p>
<p>分为 ** compChooseWord(hand, wordList, n) ** 和**  compPlayHand(hand, wordList, n)**  两部分</p>
<h4 id="compChooseWord-hand-wordList-n"><a href="#compChooseWord-hand-wordList-n" class="headerlink" title="compChooseWord(hand, wordList, n)"></a>compChooseWord(hand, wordList, n)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compChooseWord</span><span class="params">(hand, wordList, n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Given a hand and a wordList, find the word that gives </span></span><br><span class="line"><span class="string">    the maximum value score, and return it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This word should be calculated by considering all the words</span></span><br><span class="line"><span class="string">    in the wordList.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    If no words in the wordList can be made from the hand, return None.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    hand: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    wordList: list (string)</span></span><br><span class="line"><span class="string">    n: integer (HAND_SIZE; i.e., hand size required for additional points)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    returns: string or None</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># Create a new variable to store the maximum score seen so far (initially 0)</span></span><br><span class="line">    bestScore = <span class="number">0</span></span><br><span class="line">    <span class="comment"># Create a new variable to store the best word seen so far (initially None)  </span></span><br><span class="line">    bestWord = <span class="literal">None</span></span><br><span class="line">    <span class="comment"># For each word in the wordList</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> wordList:</span><br><span class="line">        <span class="comment"># If you can construct the word from your hand</span></span><br><span class="line">        <span class="keyword">if</span> isValidWord(word, hand, wordList):</span><br><span class="line">            <span class="comment"># find out how much making that word is worth</span></span><br><span class="line">            score = getWordScore(word, n)</span><br><span class="line">            <span class="comment"># If the score for that word is higher than your best score</span></span><br><span class="line">            <span class="keyword">if</span> (score &gt; bestScore):</span><br><span class="line">                <span class="comment"># update your best score, and best word accordingly</span></span><br><span class="line">                bestScore = score</span><br><span class="line">                bestWord = word</span><br><span class="line">    <span class="comment"># return the best word you found</span></span><br><span class="line">    <span class="keyword">return</span> bestWord</span><br></pre></td></tr></table></figure>

<h4 id="compPlayHand-hand-wordList-n-函数"><a href="#compPlayHand-hand-wordList-n-函数" class="headerlink" title="compPlayHand(hand, wordList, n)函数"></a>compPlayHand(hand, wordList, n)函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compPlayHand</span><span class="params">(hand, wordList, n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Allows the computer to play the given hand, following the same procedure</span></span><br><span class="line"><span class="string">    as playHand, except instead of the user choosing a word, the computer </span></span><br><span class="line"><span class="string">    chooses it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    1) The hand is displayed.</span></span><br><span class="line"><span class="string">    2) The computer chooses a word.</span></span><br><span class="line"><span class="string">    3) After every valid word: the word and the score for that word is </span></span><br><span class="line"><span class="string">    displayed, the remaining letters in the hand are displayed, and the </span></span><br><span class="line"><span class="string">    computer chooses another word.</span></span><br><span class="line"><span class="string">    4)  The sum of the word scores is displayed when the hand finishes.</span></span><br><span class="line"><span class="string">    5)  The hand finishes when the computer has exhausted its possible</span></span><br><span class="line"><span class="string">    choices (i.e. compChooseWord returns None).</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    hand: dictionary (string -&gt; int)</span></span><br><span class="line"><span class="string">    wordList: list (string)</span></span><br><span class="line"><span class="string">    n: integer (HAND_SIZE; i.e., hand size required for additional points)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># Keep track of the total score</span></span><br><span class="line">    totalScore = <span class="number">0</span></span><br><span class="line">    <span class="comment"># As long as there are still letters left in the hand:</span></span><br><span class="line">    <span class="keyword">while</span> (calculateHandlen(hand) &gt; <span class="number">0</span>) :</span><br><span class="line">        <span class="comment"># Display the hand</span></span><br><span class="line">        print(<span class="string">"Current Hand: "</span>, end=<span class="string">' '</span>)</span><br><span class="line">        displayHand(hand)</span><br><span class="line">        <span class="comment"># computer's word</span></span><br><span class="line">        word = compChooseWord(hand, wordList, n)</span><br><span class="line">        <span class="comment"># If the input is a single period:</span></span><br><span class="line">        <span class="keyword">if</span> word == <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># End the game (break out of the loop)</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># Otherwise (the input is not a single period):</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="comment"># If the word is not valid:</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">not</span> isValidWord(word, hand, wordList)) :</span><br><span class="line">                print(<span class="string">'This is a terrible error! I need to check my own code!'</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># Otherwise (the word is valid):</span></span><br><span class="line">            <span class="keyword">else</span> :</span><br><span class="line">                <span class="comment"># Tell the user how many points the word earned, and the updated total score </span></span><br><span class="line">                score = getWordScore(word, n)</span><br><span class="line">                totalScore += score</span><br><span class="line">                print(<span class="string">'"'</span> + word + <span class="string">'" earned '</span> + str(score) + <span class="string">' points. Total: '</span> + str(totalScore) + <span class="string">' points'</span>)              </span><br><span class="line">                <span class="comment"># Update hand and show the updated hand to the user</span></span><br><span class="line">                hand = updateHand(hand, word)</span><br><span class="line">                print()</span><br><span class="line">    <span class="comment"># Game is over (user entered a '.' or ran out of letters), so tell user the total score</span></span><br><span class="line">    print(<span class="string">'Total score: '</span> + str(totalScore) + <span class="string">' points.'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="主程序部分"><a href="#主程序部分" class="headerlink" title="主程序部分"></a>主程序部分</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">playGame</span><span class="params">(wordList)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Allow the user to play an arbitrary number of hands.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    1) Asks the user to input 'n' or 'r' or 'e'.</span></span><br><span class="line"><span class="string">        * If the user inputs 'e', immediately exit the game.</span></span><br><span class="line"><span class="string">        * If the user inputs anything that's not 'n', 'r', or 'e', keep asking them again.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    2) Asks the user to input a 'u' or a 'c'.</span></span><br><span class="line"><span class="string">        * If the user inputs anything that's not 'c' or 'u', keep asking them again.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    3) Switch functionality based on the above choices:</span></span><br><span class="line"><span class="string">        * If the user inputted 'n', play a new (random) hand.</span></span><br><span class="line"><span class="string">        * Else, if the user inputted 'r', play the last hand again.</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">        * If the user inputted 'u', let the user play the game</span></span><br><span class="line"><span class="string">          with the selected hand, using playHand.</span></span><br><span class="line"><span class="string">        * If the user inputted 'c', let the computer play the </span></span><br><span class="line"><span class="string">          game with the selected hand, using compPlayHand.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    4) After the computer or user has played the hand, repeat from step 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    wordList: list (string)</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># TO DO... &lt;-- Remove this comment when you code this function</span></span><br><span class="line">    <span class="comment"># print("playGame not yet implemented.") # &lt;-- Remove this when you code this function</span></span><br><span class="line">    n = HAND_SIZE</span><br><span class="line">    hand= &#123;&#125;</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        choice = input(<span class="string">"Enter n to deal a new hand, r to replay the last hand, or e to end game: "</span>)</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="string">'n'</span>:</span><br><span class="line">            hand = dealHand(n)</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                who = input(<span class="string">"Enter u to have yourself play, c to have the computer play: "</span>)</span><br><span class="line">                <span class="keyword">if</span> who <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'u'</span>,<span class="string">'c'</span>]:</span><br><span class="line">                    print(<span class="string">'Invalid command.'</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> who == <span class="string">'u'</span>:</span><br><span class="line">                playHand(hand, wordList, n)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                compPlayHand(hand, wordList, n)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">'e'</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">'r'</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> hand:</span><br><span class="line">                print(<span class="string">'You have not played a hand yet. Please play a new hand first!'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                    who = input(<span class="string">"Enter u to have yourself play, c to have the computer play: "</span>)</span><br><span class="line">                    <span class="keyword">if</span> who <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'u'</span>, <span class="string">'c'</span>):</span><br><span class="line">                        print(<span class="string">'Invalid command.'</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">if</span> who == <span class="string">'u'</span>:</span><br><span class="line">                    playHand(hand, wordList, n)</span><br><span class="line">                <span class="keyword">elif</span> who == <span class="string">'c'</span>:</span><br><span class="line">                    compPlayHand(hand, wordList, n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"Invalid command."</span>)</span><br></pre></td></tr></table></figure>

<h3 id="游戏运行"><a href="#游戏运行" class="headerlink" title="游戏运行"></a>游戏运行</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    wordList = loadWords()</span><br><span class="line">    playGame(wordList)</span><br></pre></td></tr></table></figure>

<pre><code>Loading word list from file...
   83667 words loaded.
Enter n to deal a new hand, r to replay the last hand, or e to end game: n
Enter u to have yourself play, c to have the computer play: c
Current Hand:  u e w c x f n 
&quot;enuf&quot; earned 28 points. Total: 28 points

Current Hand:  w c x 
Total score: 28 points.
Enter n to deal a new hand, r to replay the last hand, or e to end game: r
Enter u to have yourself play, c to have the computer play: u
Current Hand: u e w c x f n 
Enter word, or a &apos;.&apos; to indicate that you are finished: 。
Invalid word, please try again.
Current Hand: u e w c x f n 
Enter word, or a &apos;.&apos; to indicate that you are finished: .
Goodbye! Total score: 0 points.
Enter n to deal a new hand, r to replay the last hand, or e to end game: e</code></pre><h3 id="项目参考资料"><a href="#项目参考资料" class="headerlink" title="项目参考资料"></a>项目参考资料</h3><ol>
<li>John V. Guttag - Introduction to Computation and Programming Using Python_ With Application to Understanding Data (2016, The MIT Press)</li>
<li>Advanced Python <a href="http://www.scipy-lectures.org/advanced/advanced_python/index.html" target="_blank" rel="noopener">http://www.scipy-lectures.org/advanced/advanced_python/index.html</a></li>
<li>Python Documentation <a href="https://docs.python.org/3/index.html" target="_blank" rel="noopener">https://docs.python.org/3/index.html</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/03/deployjupyter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/03/deployjupyter/" class="post-title-link" itemprop="url">Jupyter Notebook 配置及常见技巧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-06-03 14:04:57" itemprop="dateCreated datePublished" datetime="2018-06-03T14:04:57Z">2018-06-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:24:29" itemprop="dateModified" datetime="2020-04-11T12:24:29Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>按照不同项目的要求，选择相应的 conda 环境和合适的内核。</p>
<p>顶部的选项卡是 Files、Running和 Cluster。</p>
<p>Files显示当前目录中的所有文件和文件夹。点击 Running选项卡会列出所有正在运行的 notebook。我们可以在该选项卡中管理这些 notebook。</p>
<p>Clusters 用于创建多个用于并行计算的内核。现在，一般使用 ipyparallel ，因此 cluster 选项卡如今用处不多。</p>
<h2 id="启动-Jupyter-Notebook-服务器"><a href="#启动-Jupyter-Notebook-服务器" class="headerlink" title="启动 Jupyter Notebook 服务器"></a>启动 Jupyter Notebook 服务器</h2><p>按照<a href="https://jupyter.readthedocs.io/en/latest/architecture/how_jupyter_ipython_work.html" target="_blank" rel="noopener">Jupyter文档</a>，我们可以看到整体的架构：</p>
<p>Browser————Notebook Server（read notebook files）————Kernel</p>
<p>核心是服务器，Browser 将其呈现为 Web 应用形式，保存文件为JSON 格式的 ipynb 。这样内核无需运行 python。</p>
<p>由于 notebook 和内核分离，两者之间传递任何语言的代码。早期的两个非 Python 内核分别是 R 语言和 Julia 语言。因此，Jupyter 一词，也是由 Julia、Python 和 R 组合而成。</p>
<h2 id="关闭-Jupyter"><a href="#关闭-Jupyter" class="headerlink" title="关闭 Jupyter"></a>关闭 Jupyter</h2><ol>
<li>保存 notebook，关闭</li>
<li>关闭服务器</li>
</ol>
<h2 id="notebook-界面"><a href="#notebook-界面" class="headerlink" title="notebook 界面"></a>notebook 界面</h2><p>了解 cell 和命令面板<br>自动保存快捷键：esc + “C”</p>
<h2 id="关于-Cell"><a href="#关于-Cell" class="headerlink" title="关于 Cell"></a>关于 Cell</h2><pre><code>执行代码并移动到下一格： Shift + Enter
执行代码保持在这一格：Control + Enter
代码补齐：tab
查看文档中的使用建议：Shift + Tab （可 2 次显示完整内容）</code></pre><h2 id="关于-Markdown"><a href="#关于-Markdown" class="headerlink" title="关于 Markdown"></a>关于 Markdown</h2><ol>
<li><a href="https://daringfireball.net/projects/markdown/basics" target="_blank" rel="noopener">一般使用</a></li>
<li>数学公式 <a href="http://data-blog.udacity.com/posts/2016/10/latex-primer/" target="_blank" rel="noopener">Latex使用</a> </li>
<li>Github 上的<a href="https://guides.github.com/features/mastering-markdown/" target="_blank" rel="noopener">指南</a></li>
<li>速查指南 <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet" target="_blank" rel="noopener">速查</a></li>
</ol>
<h2 id="熟悉快捷键"><a href="#熟悉快捷键" class="headerlink" title="熟悉快捷键"></a>熟悉快捷键</h2><ol>
<li>模式转换：在编辑模式和命令模式中转换。<br> 编辑模式中：增加内容。在上一个cell中执行‘shift + enter’，键入enter 进入编辑模式<br> 命令模式中：执行命令。在编辑模式中，键入escape ，进入命令模式。</li>
<li>命令模式下，可以呼出帮助列表<br> H：help list<br> A：在上方（Above）创建新的cell<br> B：在下方（Below）创建新的cell<br> M/Y：切换md与代码<br> L：打开行号表示（line number）<br> DD：连续按两次d，可以删除cell<br> S：保存文件<br> Command + P／Shift + Control：打开命令面板，搜索指令，也可以鼠标选择小键盘符号</li>
<li>总之要多尝试才能熟悉 :D</li>
</ol>
<h2 id="Magic-关键字"><a href="#Magic-关键字" class="headerlink" title="Magic 关键字"></a>Magic 关键字</h2><p>Magic 关键字是可以在单元格中运行的特殊命令，能让你控制 notebook 本身或执行系统调用,<br>例如更改目录。</p>
<blockquote>
<p>notebook 中可以使用 %matplotlib 将 matplotlib 设置为以交互方式工作</p>
</blockquote>
<p>按照作用域不同，分为两类<br>类型一：<code>%</code> 是行 magic 命令<br>类型二：<code>%%</code> 是单元格 magic 命令</p>
<ol>
<li><code>timeit</code>:计时代码的运算时间</li>
<li><code>matplotlib</code>／<code>matplotlib inline</code> :创造可视化内容时，我们可以使用对应的交互模块／绘画包，嵌入内容<br>PS：一般，可以通过命令传递参数，以选择特定后端</li>
<li><code>%pdb</code>:这是在notebook中进行调试的命令，开启交互式调试器。在代码出错的时候，可以检查当前命名空间中的变量。<br>代码调试器<a href="https://docs.python.org/3/library/pdb.html" target="_blank" rel="noopener">文档参考</a></li>
<li>更多<a href="http://ipython.readthedocs.io/en/stable/interactive/magics.html" target="_blank" rel="noopener">参考</a></li>
</ol>
<h2 id="转换-Notebook"><a href="#转换-Notebook" class="headerlink" title="转换 Notebook"></a>转换 Notebook</h2><p>注意：Notebook 时扩展名为 <code>.ipynb</code> 的大型 JSON 文件。</p>
<p>内置的 nbconvert 可以直接转换 notebook 成 HTML、Markdown、幻灯片等形式。</p>
<p>转换命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter nbconvert --to html notebook.ipynb</span><br></pre></td></tr></table></figure>
<p>转换命令<a href="https://nbconvert.readthedocs.io/en/latest/usage.html" target="_blank" rel="noopener">参考文档</a></p>
<h2 id="幻灯片展示"><a href="#幻灯片展示" class="headerlink" title="幻灯片展示"></a>幻灯片展示</h2><ol>
<li>设置显示模式：<br>在菜单栏中，点击 “View” &gt;“Cell Toolbar”&gt;“Slideshow”</li>
</ol>
<p>然后每个cell 可以定义为不同的显示类型{Slide,sub slide,fragment,skip,notes}.<br>    Slides：是你从左向右移动的完整幻灯片。<br>    Sub-slides：按上／下的箭头时，子幻灯片会显示，一般起补充说明作用。<br>    Fragments：最初是隐藏的。<br>    Skip：会忽略幻灯片中的单元格<br>    Notes：会将为演讲者保留备注</p>
<ol start="2">
<li>运行幻灯片</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter nbconvert notebook.ipynb --to slides</span><br></pre></td></tr></table></figure>

<p>这条命令可以直接将 notebook 转换为幻灯片所需要的文件，但还需要提交给 HTTP 服务器才能真正看到演示文稿。</p>
<p>** 提交到服务器，并直接显示! **</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter nbconvert notebook.ipynb --to slides --post serve</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/18/anaconda/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/05/18/anaconda/" class="post-title-link" itemprop="url">About Anaconda</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-05-18 19:38:24" itemprop="dateCreated datePublished" datetime="2018-05-18T19:38:24Z">2018-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-07 12:23:20" itemprop="dateModified" datetime="2020-04-07T12:23:20Z">2020-04-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Notes/" itemprop="url" rel="index"><span itemprop="name">Notes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h2><p>仍在更新中……<br> Anaconda和 Jupyter Notebook 使用后的推荐度很高，在此整理一下笔记。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h3><p> Anaconda 是数据科学常用包的 Python 发行版，简单理解为管理工具。<br>其主要基于 conda 衍生而来，而这个 conda 就是包／环境管理器。<br>它可以帮助你更简单地按照不同的项目需求创建编程环境；分隔不同 Python 版本、不同包版本；安装、卸载和更新包。<br>除了 conda ，其中还包含 150 多个包及 dependency。</p>
<h2 id="Conda"><a href="#Conda" class="headerlink" title="Conda"></a>Conda</h2><h3 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h3><p>包管理器用于在计算机上安装库和其他软件。平时使用 python 的时候，我们通常使用默认的 Python 默认包管理器 pip。conda 与之相似，但其中可管理的包为数据科学领域，也支持其他非 Python 包。</p>
<h3 id="虚拟环境管理"><a href="#虚拟环境管理" class="headerlink" title="虚拟环境管理"></a>虚拟环境管理</h3><p>conda 同时还有虚拟环境管理的作用，类似于 virtualenv 和 pyenv 。</p>
<h3 id="Jupyter-notebook"><a href="#Jupyter-notebook" class="headerlink" title="Jupyter notebook"></a>Jupyter notebook</h3><p>本质上是一种文档，其中可以组合保存说明文本、图像、代码（可执行）、公式和其他可视化内容。<br>自2011年开始流行，目前已经成为了数据分析的标准环境。</p>
<h2 id="安装-Anaconda"><a href="#安装-Anaconda" class="headerlink" title="安装 Anaconda"></a>安装 Anaconda</h2><p>anaconda 中使用的 Python 不影响以及安装在本地的 Python 。它使用的是 anaconda 附带的 Python。<br>使用 <code>conda list</code> 命令查看所有安装的包版本。<br>使用  <code>conda upgrade --all</code> 命令更新所有，避免报错。<br>使用  <code>conda install package_name</code> 安装新包<br>    可以多个，例如 conda install numpy scipy pandas<br>    也可指定版本号 conda install numpy= 1.09</p>
<p>安装时会自动安装 dependency<br>使用 <code>conda remove package_name</code>  卸载<br>使用 <code>conda upgrade package_name</code> 更新<br>不知道包的具体名字，则用 <code>conda search search_term</code> 搜索</p>
<h2 id="环境管理"><a href="#环境管理" class="headerlink" title="环境管理"></a>环境管理</h2><h3 id="创建环境"><a href="#创建环境" class="headerlink" title="创建环境"></a>创建环境</h3><p><code>conda create -n env_name list of packages</code></p>
<h3 id="进入环境"><a href="#进入环境" class="headerlink" title="进入环境"></a>进入环境</h3><p><code>source activate my_env</code> 进入环境</p>
<h3 id="保存和加载环境"><a href="#保存和加载环境" class="headerlink" title="保存和加载环境"></a>保存和加载环境</h3><p><code>conda env export &gt; environment.yaml</code>  保存环境为YAML </p>
<h3 id="列出环境"><a href="#列出环境" class="headerlink" title="列出环境"></a>列出环境</h3><p><code>conda env list</code></p>
<h3 id="删除环境"><a href="#删除环境" class="headerlink" title="删除环境"></a>删除环境</h3><p><code>conda env remove -n env_name</code></p>
<h2 id="安装使用-Jupyter-notebook"><a href="#安装使用-Jupyter-notebook" class="headerlink" title="安装使用 Jupyter notebook"></a>安装使用 Jupyter notebook</h2><p>notebook 能将数据处理后需要展示的一切内容集中在一起。</p>
<h3 id="题外话：文学化编程概念"><a href="#题外话：文学化编程概念" class="headerlink" title="题外话：文学化编程概念"></a>题外话：文学化编程概念</h3><p>早在1984年，Donald Knuth 就提出了 Notebook 所应用的文字表达编程的概念。我们不只是可以为程序编写额外的文档内容，而是可以讲文字叙述和程序代码融合在一起。更好地向人解释，我们如何解决问题的逻辑和方法。</p>
<p><code>让我们集中精力向人们解释我们希望计算机做什么，而不是指示计算机做什么。</code></p>
<p>文学化编程概念已经发展成为了一门完整的编程语言，即 Eve。</p>
<h3 id="在-anaconda-环境中安装-notebook"><a href="#在-anaconda-环境中安装-notebook" class="headerlink" title="在 anaconda 环境中安装 notebook"></a>在 anaconda 环境中安装 notebook</h3><p><code>conda install jupyter notebook</code> 即可</p>
<h3 id="启动-notebook"><a href="#启动-notebook" class="headerlink" title="启动 notebook"></a>启动 notebook</h3><p><code>jupyter notebook</code></p>
<p>服务器主页会在浏览器页面中打开。默认情况下，notebook 服务器的运行地址是 <a href="http://localhost:8888。">http://localhost:8888。</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/07/10/hangman/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/07/10/hangman/" class="post-title-link" itemprop="url">Hangman：经典单词游戏</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-07-10 19:42:39" itemprop="dateCreated datePublished" datetime="2013-07-10T19:42:39Z">2013-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:26:00" itemprop="dateModified" datetime="2020-04-11T12:26:00Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl,dr"></a>tl,dr</h2><p>在童年时代的剑桥英语课上，老师为了提高大家学习语言的兴趣带我们玩过类似的猜单词游戏。而再次接触到这个游戏并留下深刻印象（马失前蹄小人突然被吊死，悲惨接受 game over 结局），则要到中学阶段的文曲星上了。<br>所谓的 classic 随着时代的变化，都成为了并不遥远，但也已经朦朦胧胧的美好记忆了。</p>
<h2 id="游戏规则"><a href="#游戏规则" class="headerlink" title="游戏规则"></a>游戏规则</h2><p>基本的游戏规则如下：<a href="https://en.wikipedia.org/wiki/Hangman_(game" target="_blank" rel="noopener">Wiki/Hangman</a></p>
<h3 id="交互方式"><a href="#交互方式" class="headerlink" title="交互方式"></a>交互方式</h3><ol>
<li>游戏开始阶段，玩家需要被告知需要猜测的单词的长度</li>
<li>玩家每轮提供一次猜测（字母）</li>
<li>计算机给出对本轮猜测的判定结果</li>
<li>显示本轮猜测之后当前单词猜测状态（已经猜对的部分显示，未能猜出的部分用符号之类替代留出）</li>
</ol>
<h3 id="额外规则"><a href="#额外规则" class="headerlink" title="额外规则"></a>额外规则</h3><ul>
<li>每次游戏的玩家可以有 8 次游戏机会。</li>
<li>每轮结束后，计算机给出提示，还有 * 次机会</li>
<li>假定玩家每轮只输入一个字母（A-Z），如果猜测不在答案之中，则本轮失败。</li>
<li>如果玩家多次猜测相同字母，不计入失败，而是显示信息：已经猜过了，请再试一次</li>
<li>猜对单词中的全部字母，则游戏挑战成功。使用完全部机会，则游戏挑战失败</li>
</ul>
<h2 id="分解函数"><a href="#分解函数" class="headerlink" title="分解函数"></a>分解函数</h2><p>而复现这个刽子手的游戏，编程前需要如何规划？</p>
<ol>
<li>首先，需要构建两个大模块<ul>
<li>helper functions， 完成辅助性函数的定义</li>
<li>hangman：游戏主程序</li>
</ul>
</li>
<li>划分功能<ul>
<li>Is the Word Guessed，<br>  函数：用来判断这个字母是否已经猜过<br>  isWordGuessed 函数有两个参数：<pre><code>1. string 的 secretWord
2. list 的 lettersGuessed</code></pre>  返回 boolean：<pre><code>如果secretWord已经猜测过，True
else False</code></pre></li>
<li>Printing Out the User’s Guess<br>  函数：用来显示玩家当前猜测轮后单词的“被猜测”状态<pre><code>getGuessedWord 也是两个参数，secretWord，lettersGuessed
secretWord 是 string 需要转成 list 才可以更改
用&apos; _ &apos; 代替没有猜到的字母
返回替代修改后的单词</code></pre></li>
<li>Printing Out all Available Letters<br>  函数：显示当前可用的单词<pre><code>调用了string.ascii_lowercase
如果字母在猜测过的列表中，则从可用中去除</code></pre></li>
</ul>
</li>
</ol>
<h2 id="思考过程"><a href="#思考过程" class="headerlink" title="思考过程"></a>思考过程</h2><p>在真正开始搭建游戏的主程序之前，我们先完成小的函数模块。<br>在 hangman 主程序中拼接小的功能、循环控制游戏进程、提供输入输出的信息与玩家进行交互。<br>主要用到 list、string 之类的简单知识，并不难但是编程思想非常重要 XD<br><a href="https://docs.python.org/3/tutorial/datastructures.html" target="_blank" rel="noopener">参考</a></p>
<h2 id="Code-Solution-如下"><a href="#Code-Solution-如下" class="headerlink" title="Code Solution 如下"></a>Code Solution 如下</h2><h3 id="isWordGuessed-secretWord-lettersGuessed"><a href="#isWordGuessed-secretWord-lettersGuessed" class="headerlink" title="isWordGuessed(secretWord, lettersGuessed)"></a>isWordGuessed(secretWord, lettersGuessed)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def isWordGuessed(secretWord, lettersGuessed):</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    secretWord: string, the word the user is guessing</span><br><span class="line">    lettersGuessed: list, what letters have been guessed so far</span><br><span class="line">    returns: boolean, True if all the letters of secretWord are in lettersGuessed;</span><br><span class="line">      False otherwise</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    gussed &#x3D; True</span><br><span class="line">    for elm in secretWord:</span><br><span class="line">        if elm not in lettersGuessed:</span><br><span class="line">            gussed &#x3D; False</span><br><span class="line">    return gussed</span><br></pre></td></tr></table></figure>

<h3 id="getGuessedWord-secretWord-lettersGuessed"><a href="#getGuessedWord-secretWord-lettersGuessed" class="headerlink" title="getGuessedWord(secretWord, lettersGuessed)"></a>getGuessedWord(secretWord, lettersGuessed)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def getGuessedWord(secretWord,  ):</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    secretWord: string, the word the user is guessing</span><br><span class="line">    lettersGuessed: list, what letters have been guessed so far</span><br><span class="line">    returns: string, comprised of letters and underscores that represents</span><br><span class="line">      what letters in secretWord have been guessed so far.</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    ans &#x3D; list(secretWord)</span><br><span class="line">    for i in range(0,len(secretWord)):</span><br><span class="line">        if ans[i] not in lettersGuessed:</span><br><span class="line">            ans[i] &#x3D; &#39; _ &#39; </span><br><span class="line">    return &#39;&#39;.join(ans)</span><br></pre></td></tr></table></figure>

<h3 id="getAvailableLetters-lettersGuessed"><a href="#getAvailableLetters-lettersGuessed" class="headerlink" title="getAvailableLetters(lettersGuessed)"></a>getAvailableLetters(lettersGuessed)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def getAvailableLetters(lettersGuessed):</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    lettersGuessed: list, what letters have been guessed so far</span><br><span class="line">    returns: string, comprised of letters that represents what letters have not</span><br><span class="line">      yet been guessed.</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    alpha &#x3D; list(string.ascii_lowercase)</span><br><span class="line">    ans &#x3D;[]</span><br><span class="line">    for i in range(0,len(alpha)):</span><br><span class="line">        if alpha[i] not in lettersGuessed:</span><br><span class="line">            ans.append(alpha[i])</span><br><span class="line">    return &#39;&#39;.join(ans)</span><br></pre></td></tr></table></figure>

<h3 id="hangman"><a href="#hangman" class="headerlink" title="hangman"></a>hangman</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hangman</span><span class="params">(secretWord)</span>:</span></span><br><span class="line"></span><br><span class="line">    secretWord: string, the secret word to guess.</span><br><span class="line"></span><br><span class="line">    Starts up an interactive game of Hangman.</span><br><span class="line"></span><br><span class="line">    * At the start of the game, let the user know how many </span><br><span class="line">      letters the secretWord contains.</span><br><span class="line"></span><br><span class="line">    * Ask the user to supply one guess (i.e. letter) per round.</span><br><span class="line"></span><br><span class="line">    * The user should receive feedback immediately after each guess </span><br><span class="line">      about whether their guess appears <span class="keyword">in</span> the computers word.</span><br><span class="line"></span><br><span class="line">    * After each round, you should also display to the user the </span><br><span class="line">      partially guessed word so far, <span class="keyword">as</span> well <span class="keyword">as</span> letters that the </span><br><span class="line">      user has <span class="keyword">not</span> yet guessed.</span><br><span class="line"></span><br><span class="line">    Follows the other limitations detailed <span class="keyword">in</span> the problem write-up.</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    num_word = len(secretWord)</span></span><br><span class="line"><span class="string">    print("Welcome to the game, Hangman!")</span></span><br><span class="line"><span class="string">    print("I am thinking of a word that is " + str(num_word) + " letters long.")</span></span><br><span class="line"><span class="string">    print("-----------")</span></span><br><span class="line"><span class="string">    letters_Guessed = []</span></span><br><span class="line"><span class="string">    left_guess = 8</span></span><br><span class="line"><span class="string">    while left_guess &gt; 0:</span></span><br><span class="line"><span class="string">        print("You have " + str(left_guess) + " guesses left.")</span></span><br><span class="line"><span class="string">        print("Available letters: " + str(getAvailableLetters(letters_Guessed)))</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # get input guess from player:</span></span><br><span class="line"><span class="string">        # Please guess a letter: a</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        new_input_letter = input("Please guess a letter: ")</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # Case one : if You have alreaday guessed</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        while new_input_letter in letters_Guessed:</span></span><br><span class="line"><span class="string">            print("Oops! You've already guessed that letter: " + str(getGuessedWord(secretWord, letters_Guessed)))</span></span><br><span class="line"><span class="string">            print("-----------")</span></span><br><span class="line"><span class="string">            print("You have " + str(left_guess) + " guesses left.")</span></span><br><span class="line"><span class="string">            print("Available letters: " + str(getAvailableLetters(letters_Guessed)))</span></span><br><span class="line"><span class="string">            new_input_letter = input("Please guess a letter: ")       </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        letters_Guessed.append(new_input_letter)</span></span><br><span class="line"><span class="string">        # Case Two: success guess</span></span><br><span class="line"><span class="string">        if new_input_letter in secretWord:</span></span><br><span class="line"><span class="string">            print("Good guess: " + str(getGuessedWord(secretWord, letters_Guessed)))</span></span><br><span class="line"><span class="string">            print("-----------")</span></span><br><span class="line"><span class="string">        else :</span></span><br><span class="line"><span class="string">            print("Oops! That letter is not in my word: " +  str(getGuessedWord(secretWord, letters_Guessed)))</span></span><br><span class="line"><span class="string">            print("-----------")</span></span><br><span class="line"><span class="string">            left_guess -= 1</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        # check the game win condition</span></span><br><span class="line"><span class="string">        if isWordGuessed(secretWord, letters_Guessed):</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            print("Congratulations, you won!")</span></span><br><span class="line"><span class="string">            return None</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    print("Sorry, you ran out of guesses. The word was else.")</span></span><br><span class="line"><span class="string">    return None</span></span><br></pre></td></tr></table></figure>


<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>进行测试时，我们需要提供包括所有情况的测试案例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">secretWord &#x3D; chooseWord(wordlist).lower()</span><br><span class="line">hangman(secretWord)</span><br></pre></td></tr></table></figure>

<h2 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h2><p>分别使用</p>
<p>1：成功猜测一个短单词的情况</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the game, Hangman!</span><br><span class="line">I am thinking of a word that is 1 letters long.</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: c</span><br><span class="line">Good guess: c</span><br><span class="line">-----------</span><br><span class="line">Congratulations, you won!</span><br><span class="line">None</span><br></pre></td></tr></table></figure>

<p>2：单词中是重复字母的情况</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the game, Hangman!</span><br><span class="line">I am thinking of a word that is 3 letters long.</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: z</span><br><span class="line">Good guess: zzz</span><br><span class="line">-----------</span><br><span class="line">Congratulations, you won!</span><br><span class="line">None</span><br></pre></td></tr></table></figure>

<p>3：猜测极短但失败用例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the game, Hangman!</span><br><span class="line">I am thinking of a word that is 1 letters long.</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: a</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 7 guesses left.</span><br><span class="line">Available letters: bcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: b</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 6 guesses left.</span><br><span class="line">Available letters: cdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: d</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 5 guesses left.</span><br><span class="line">Available letters: cefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: e</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 4 guesses left.</span><br><span class="line">Available letters: cfghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: f</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 3 guesses left.</span><br><span class="line">Available letters: cghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: g</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 2 guesses left.</span><br><span class="line">Available letters: chijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: h</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 1 guesses left.</span><br><span class="line">Available letters: cijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: i</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">Sorry, you ran out of guesses. The word was else.</span><br><span class="line">None</span><br></pre></td></tr></table></figure>

<p>4：游戏最终成功的用例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the game, Hangman!</span><br><span class="line">I am thinking of a word that is 3 letters long.</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: a</span><br><span class="line">Good guess: _ _ a</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: bcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: e</span><br><span class="line">Good guess: _ ea</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: bcdfghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: a</span><br><span class="line">Oops! You&#39;ve already guessed that letter: _ ea</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: bcdfghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: e</span><br><span class="line">Oops! You&#39;ve already guessed that letter: _ ea</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: bcdfghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: s</span><br><span class="line">Good guess: sea</span><br><span class="line">-----------</span><br><span class="line">Congratulations, you won!</span><br><span class="line">None</span><br></pre></td></tr></table></figure>

<p>5：不断失败的用例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the game, Hangman!</span><br><span class="line">I am thinking of a word that is 1 letters long.</span><br><span class="line">-----------</span><br><span class="line">You have 8 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">Please guess a letter: x</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 7 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwyz</span><br><span class="line">Please guess a letter: z</span><br><span class="line">Oops! That letter is not in my word: _ </span><br><span class="line">-----------</span><br><span class="line">You have 6 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwy</span><br><span class="line">Please guess a letter: x</span><br><span class="line">Oops! You&#39;ve already guessed that letter: _ </span><br><span class="line">-----------</span><br><span class="line">You have 6 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwy</span><br><span class="line">Please guess a letter: z</span><br><span class="line">Oops! You&#39;ve already guessed that letter: _ </span><br><span class="line">-----------</span><br><span class="line">You have 6 guesses left.</span><br><span class="line">Available letters: abcdefghijklmnopqrstuvwy</span><br><span class="line">Please guess a letter: y</span><br><span class="line">Good guess: y</span><br><span class="line">-----------</span><br><span class="line">Congratulations, you won!</span><br><span class="line">None</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/15/recover/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/06/15/recover/" class="post-title-link" itemprop="url">Recover：恢复记忆卡中的 JPEG 图片</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-06-15 20:20:04" itemprop="dateCreated datePublished" datetime="2013-06-15T20:20:04Z">2013-06-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:27:37" itemprop="dateModified" datetime="2020-04-11T12:27:37Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h3><p>从 card.raw 中识别 JPEG 的数据，将其恢复出来。</p>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><ol>
<li>打开存储卡card.raw 读取其中数据（使用fopen()</li>
<li>识别 JPEG 的header<br> 注意：JPEG 也只是一系列bytes，只是每一个 JPEG 都有相同的header<br> 前三个byte：是 0xff 0xd8 0xff<br> 下一个：0xe0—到–0xef<br> 读取时每一个 block 是 512 bytes</li>
<li>打开一个新的 JPEG 文件，将文件名保存为  ???.jpeg（1～n）</li>
<li>写入这一个block 的 512 byte 直到发现新的文件头出现</li>
<li>检查是否已经读取到文件的末尾</li>
</ol>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ol>
<li>读取文件的fread()<br> fread(data,size,number,inptr)<br> data: pointer to such truct that will contain the bytes you are reading<br> size: size of each element to read<br> sizeof<br> number: number of elements to read<br> inptr: FILE * to read from</li>
<li>识别 JPEG：<br> if (buffer[0] == 0xff &amp;&amp;<pre><code>buffer[1] == 0xd8 &amp;&amp;
buffer[2] == 0xff &amp;&amp;
(buffer[3] &amp; 0xf0) == 0xe0)</code></pre></li>
<li>按照需要存储新图片，使用函数 sprintf(filename,”%03i.jpg”,2)<br> filename: char array to store the result tring<br> 002.jpg<br> FILE *image = fopen(filename,”w”)</li>
<li>使用 fwrite 函数写入内容<br> fwrite(data,size,number,outptr)<br> fwrite(buffer, sizeof(buffer), 1, image)</li>
<li>使用的数据结构<br> 定义了 typedef uint8_t BYTE，使用了 BYTE buffer[512]</li>
</ol>
<h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ol>
<li><a href="https://docs.cs50.net/2018/x/psets/4/recover/recover.html" target="_blank" rel="noopener">https://docs.cs50.net/2018/x/psets/4/recover/recover.html</a></li>
</ol>
<h3 id="Code-Solution"><a href="#Code-Solution" class="headerlink" title="Code Solution"></a>Code Solution</h3><figure class="highlight c"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cs50.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint8_t</span> BYTE;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the name of a forensic image as command-line argument</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ensure proper usage</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Usage: recover infile outfile\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remember input filenames from the only argument</span></span><br><span class="line">    <span class="keyword">char</span> *infile = argv[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// open input file</span></span><br><span class="line">    FILE *inptr = fopen(infile, <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span> (inptr == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Could not open %s.\n"</span>, infile);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//read file and check the first 4 signature</span></span><br><span class="line">    BYTE <span class="built_in">buffer</span>[<span class="number">512</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> filename[<span class="number">8</span>];</span><br><span class="line">    FILE *<span class="built_in">image</span> = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">int</span> newnameJPEG = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// check whether it is a JPEG start</span></span><br><span class="line">    <span class="keyword">bool</span> isJPEG = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (fread(<span class="built_in">buffer</span>, <span class="keyword">sizeof</span>(<span class="built_in">buffer</span>), <span class="number">1</span>, inptr) == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//check whether the first 4 buffer indicates a JPEG</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">buffer</span>[<span class="number">0</span>] == <span class="number">0xff</span> &amp;&amp;</span><br><span class="line">            <span class="built_in">buffer</span>[<span class="number">1</span>] == <span class="number">0xd8</span> &amp;&amp;</span><br><span class="line">            <span class="built_in">buffer</span>[<span class="number">2</span>] == <span class="number">0xff</span> &amp;&amp;</span><br><span class="line">            (<span class="built_in">buffer</span>[<span class="number">3</span>] &amp; <span class="number">0xf0</span>) == <span class="number">0xe0</span>)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">            isJPEG = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//making a new JPEG</span></span><br><span class="line">            <span class="built_in">sprintf</span>(filename, <span class="string">"%03i.jpg"</span>, newnameJPEG);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//create file(JPEG) to write</span></span><br><span class="line">            <span class="built_in">image</span> = fopen(filename, <span class="string">"w"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//prepare next</span></span><br><span class="line">            newnameJPEG ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isJPEG == <span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fwrite(<span class="built_in">buffer</span>, <span class="keyword">sizeof</span>(<span class="built_in">buffer</span>), <span class="number">1</span>, <span class="built_in">image</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// close infile</span></span><br><span class="line">    fclose(inptr);</span><br><span class="line">    fclose(<span class="built_in">image</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/01/codehidden/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/06/01/codehidden/" class="post-title-link" itemprop="url">Whodunit：破译侦探游戏中的隐写信息</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-06-01 20:59:08" itemprop="dateCreated datePublished" datetime="2013-06-01T20:59:08Z">2013-06-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:23:08" itemprop="dateModified" datetime="2020-04-11T12:23:08Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h2><p>这个程序可以将位图中的隐藏信息破译出来。<br>不过，目前解码信息的规则很简单，因为噪点都是红色的，只需要将0000ff全部转变成ffffff，生成新的图片，即可看到被覆盖的隐写信息。</p>
<h2 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h2><p>一些儿童向的冒险小说里会夹杂这种类型的侦探卡片，覆盖在空无一物的图片上即可显现真实的信息。计算机程序所能做到的也是如此。</p>
<h3 id="关于色彩"><a href="#关于色彩" class="headerlink" title="关于色彩"></a>关于色彩</h3><p>黑白色彩 = 1 bit = 1/0 分别表示白或黑 2 色</p>
<p>GIF ：支持 8 bit color<br>BMP／JPEG／PNG ：都支持 24-bit color<br>BMP 实际上可以支持 1-, 4-, 8-, 16-, 24-, 32-bit color</p>
<p>24 bit color 中的 RGB color：<br>8    red        R<br>8    green    G<br>8    blue    B</p>
<h3 id="关于-BMP"><a href="#关于-BMP" class="headerlink" title="关于 BMP"></a>关于 BMP</h3><p><a href="https://msdn.microsoft.com/en-us/library/dd183377.aspx" target="_blank" rel="noopener">bitmap - by MS</a></p>
<p>BMP文件在文件开始会包含一些 metadata：<br>14 byte 大小的结构体 BITMAPFILEHEADER<br>40 byte 大小的结构体 BITMAPINFOHEADER<br>一共 54 byte</p>
<p><img src="/tempimg/BITHEADER.jpg" alt="BITMAP HEADER"><br>（在1-, 4-,16-bit BMP中，还有代表“色彩饱和度”的 RGBQUAD ）</p>
<p>其中 BMP 对色彩 triple 的存储方法都是完全逆向 BGR，有些甚至是每一个像素点逆向存储的。</p>
<p>PS:BMP 4.0 的 magic number 是0x4d42</p>
<h3 id="关于-padding"><a href="#关于-padding" class="headerlink" title="关于 padding"></a>关于 padding</h3><p>微软开发者制定了规则，每一行 scanline 需要是 32-bit DWORD的倍数<br>所以 scanline 不能被 4 整除的话就需要增加 padding。</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Data_structure_alignment" target="_blank" rel="noopener"> Data Structure Padding</a></li>
<li><a href="http://www.drdobbs.com/architecture-and-design/the-bmp-file-format-part-1/184409517" target="_blank" rel="noopener">BMP format</a></li>
</ul>
<h2 id="其他注意点"><a href="#其他注意点" class="headerlink" title="其他注意点"></a>其他注意点</h2><ol>
<li>异常情况判断，错误抛出</li>
<li>读取原始位图内容、padding调整、按照解密规则替换像素颜色、输出结果</li>
</ol>
<h2 id="Code-Solution"><a href="#Code-Solution" class="headerlink" title="Code Solution"></a>Code Solution</h2><figure class="highlight c"><figcaption><span>[whodunit.c] []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"bmp.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ensure:program should accept exactly two command-line arguments</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// remind the user of correct usage,</span></span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Usage: change infile outfile\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// remember filenames</span></span><br><span class="line">    <span class="keyword">char</span> *infile = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">char</span> *outfile = argv[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// open input file</span></span><br><span class="line">    FILE *inptr = fopen(infile, <span class="string">"r"</span>);</span><br><span class="line">    <span class="comment">// if input file cannot be opened for reading</span></span><br><span class="line">    <span class="comment">// return 2 and reming</span></span><br><span class="line">    <span class="keyword">if</span> (inptr == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Could not open %s.\n"</span>, infile);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// open output file</span></span><br><span class="line">    FILE *outptr = fopen(outfile, <span class="string">"w"</span>);</span><br><span class="line">    <span class="comment">// if the output file cannot be opened for writing</span></span><br><span class="line">    <span class="comment">// return 3 and remind</span></span><br><span class="line">    <span class="keyword">if</span> (outptr == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fclose(inptr);</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Could not create %s.\n"</span>, outfile);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read infile's BITMAPFILEHEADER</span></span><br><span class="line">    BITMAPFILEHEADER bf;</span><br><span class="line">    fread(&amp;bf, <span class="keyword">sizeof</span>(BITMAPFILEHEADER), <span class="number">1</span>, inptr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read infile's BITMAPINFOHEADER</span></span><br><span class="line">    BITMAPINFOHEADER bi;</span><br><span class="line">    fread(&amp;bi, <span class="keyword">sizeof</span>(BITMAPINFOHEADER), <span class="number">1</span>, inptr);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ensure infile is (likely) a 24-bit uncompressed BMP 4.0</span></span><br><span class="line">    <span class="keyword">if</span> (bf.bfType != <span class="number">0x4d42</span> || bf.bfOffBits != <span class="number">54</span> || bi.biSize != <span class="number">40</span> ||</span><br><span class="line">        bi.biBitCount != <span class="number">24</span> || bi.biCompression != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fclose(outptr);</span><br><span class="line">        fclose(inptr);</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Unsupported file format.\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ensure infile is  a 24-bit uncompressed BMP 4.0</span></span><br><span class="line">    <span class="keyword">if</span> (bf.bfType != <span class="number">0x4d42</span> || bf.bfOffBits != <span class="number">54</span> || bi.biSize != <span class="number">40</span> ||</span><br><span class="line">        bi.biBitCount != <span class="number">24</span> || bi.biCompression != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fclose(outptr);</span><br><span class="line">        fclose(inptr);</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Unsupported file format.\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write outfile's BITMAPFILEHEADER</span></span><br><span class="line">    fwrite(&amp;bf, <span class="keyword">sizeof</span>(BITMAPFILEHEADER), <span class="number">1</span>, outptr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// write outfile's BITMAPINFOHEADER</span></span><br><span class="line">    fwrite(&amp;bi, <span class="keyword">sizeof</span>(BITMAPINFOHEADER), <span class="number">1</span>, outptr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// determine padding for scanlines</span></span><br><span class="line">    <span class="keyword">int</span> padding = (<span class="number">4</span> - (bi.biWidth * <span class="keyword">sizeof</span>(RGBTRIPLE)) % <span class="number">4</span>) % <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// iterate over infile's scanlines</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, biHeight = <span class="built_in">abs</span>(bi.biHeight); i &lt; biHeight; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// iterate over pixels in scanline</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; bi.biWidth; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// temporary storage</span></span><br><span class="line">            RGBTRIPLE triple;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// read RGB triple from infile</span></span><br><span class="line">            fread(&amp;triple, <span class="keyword">sizeof</span>(RGBTRIPLE), <span class="number">1</span>, inptr);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//<span class="doctag">TODO:</span> change the color of red to white</span></span><br><span class="line">            <span class="keyword">if</span> (triple.rgbtBlue == <span class="number">0x00</span> &amp;&amp; triple.rgbtGreen == <span class="number">0x00</span> &amp;&amp; triple.rgbtRed == <span class="number">0xff</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                triple.rgbtBlue = <span class="number">0xff</span>;</span><br><span class="line">                triple.rgbtGreen = <span class="number">0xff</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// write RGB triple to outfile</span></span><br><span class="line">            fwrite(&amp;triple, <span class="keyword">sizeof</span>(RGBTRIPLE), <span class="number">1</span>, outptr);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// skip over padding, if any</span></span><br><span class="line">        fseek(inptr, padding, SEEK_CUR);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// then add it back (to demonstrate how)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; padding; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            fputc(<span class="number">0x00</span>, outptr);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// close infile</span></span><br><span class="line">    fclose(inptr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// close outfile</span></span><br><span class="line">    fclose(outptr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// success</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>[bmp.h] []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BMP-related data types based on Microsoft's own</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// aliases for C/C++ primitive data types</span></span><br><span class="line"><span class="comment">// https://msdn.microsoft.com/en-us/library/cc230309.aspx</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint8_t</span>  BYTE;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> DWORD;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int32_t</span>  LONG;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint16_t</span> WORD;</span><br><span class="line"></span><br><span class="line"><span class="comment">// information about the type, size, and layout of a file</span></span><br><span class="line"><span class="comment">// https://msdn.microsoft.com/en-us/library/dd183374(v=vs.85).aspx</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    WORD bfType;</span><br><span class="line">    DWORD bfSize;</span><br><span class="line">    WORD bfReserved1;</span><br><span class="line">    WORD bfReserved2;</span><br><span class="line">    DWORD bfOffBits;</span><br><span class="line">&#125; __attribute__((__packed__))</span><br><span class="line">BITMAPFILEHEADER;</span><br><span class="line"></span><br><span class="line"><span class="comment">// information about the dimensions and color format</span></span><br><span class="line"><span class="comment">// https://msdn.microsoft.com/en-us/library/dd183376(v=vs.85).aspx</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    DWORD biSize;</span><br><span class="line">    LONG biWidth;</span><br><span class="line">    LONG biHeight;</span><br><span class="line">    WORD biPlanes;</span><br><span class="line">    WORD biBitCount;</span><br><span class="line">    DWORD biCompression;</span><br><span class="line">    DWORD biSizeImage;</span><br><span class="line">    LONG biXPelsPerMeter;</span><br><span class="line">    LONG biYPelsPerMeter;</span><br><span class="line">    DWORD biClrUsed;</span><br><span class="line">    DWORD biClrImportant;</span><br><span class="line">&#125; __attribute__((__packed__))</span><br><span class="line">BITMAPINFOHEADER;</span><br><span class="line"></span><br><span class="line"><span class="comment">// relative intensities of red, green, and blue</span></span><br><span class="line"><span class="comment">// https://msdn.microsoft.com/en-us/library/dd162939(v=vs.85).aspx</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    BYTE rgbtBlue;</span><br><span class="line">    BYTE rgbtGreen;</span><br><span class="line">    BYTE rgbtRed;</span><br><span class="line">&#125; __attribute__((__packed__))</span><br><span class="line">RGBTRIPLE;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/05/24/cmusic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2013/05/24/cmusic/" class="post-title-link" itemprop="url">Synthesize：模拟读谱进行音乐合成</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2013-05-24 19:36:22" itemprop="dateCreated datePublished" datetime="2013-05-24T19:36:22Z">2013-05-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-11 12:22:22" itemprop="dateModified" datetime="2020-04-11T12:22:22Z">2020-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tl-dr"><a href="#tl-dr" class="headerlink" title="tl;dr"></a>tl;dr</h2><ol>
<li><p>阅读乐谱</p>
</li>
<li><p>阅读源代码</p>
</li>
<li><p>将乐谱转换成频率</p>
</li>
<li><p>模拟合成一段音乐</p>
</li>
</ol>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>一支乐曲是一系列音符构成的，在乐谱上每个音符是一个具备时间长度、音高的标志。在西方音乐记谱中，每一个音符使用字母A-G表示。这些音在钢琴上位于白键上，因此称为自然音。</p>
<p>A-（la） B-（si） C-（do） D-（re）E-（mi）F-（fa）G-（so）</p>
<p>升降符号（#／b）用于表示与白键的接近程度。<br>键盘上的相邻音之间为半音的间隔（semitone）。</p>
<p><img src="/tempimg/semitone.png" alt="semitone"></p>
<p>钢琴共有88个键，其中52个为白键，仅用七个字母表示并不充分。八度（octaves）一组，即连续的七个音组成的音阶可以和音名一起表示键盘上的某个音。</p>
<p><img src="/tempimg/octaves.png" alt="octaves"></p>
<p>按动琴键，琴槌会敲击琴弦，琴弦振动产生波，波抵达人耳，就能听见乐音。<br>波动的频率越大，音高越高。</p>
<p>source：(奇妙的音乐数学)[<a href="https://plus.maths.org/content/magical-mathematics-music]" target="_blank" rel="noopener">https://plus.maths.org/content/magical-mathematics-music]</a></p>
<h3 id="A4"><a href="#A4" class="headerlink" title="A4"></a>A4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C4 &#x3D; midle C</span><br><span class="line">A3 &#x3D; 220 Hz</span><br><span class="line">A4 &#x3D; 440 Hz &#x3D; A440</span><br><span class="line">A5 &#x3D; 440 * 2 Hz</span><br><span class="line">……</span><br><span class="line">f &#x3D; (2^n&#x2F;12) × 440</span><br></pre></td></tr></table></figure>

<h3 id="Visual-Notation"><a href="#Visual-Notation" class="headerlink" title="Visual Notation"></a>Visual Notation</h3><p>一般的记谱并不使用频率或符号，而是用视觉化方法表示——五线谱。位置代表音高，时值是音持续的时间长度。</p>
<h2 id="Analyze-music-zip"><a href="#Analyze-music-zip" class="headerlink" title="Analyze music.zip"></a>Analyze music.zip</h2><ol>
<li><p><code>songs／</code> 目录下均为文本文件，存储的是不同歌曲的谱面。空行代表 1/8 休止符</p>
</li>
<li><p><code>notes.c</code>输出note：频率，（如A#4:440），并在wav中输出对应音高的音符。<br>同时对错误信息给出输出提示。<br>使用到的函数<code>song_open</code>, <code>frequency</code>, <code>note_write</code>, <code>song_close</code>在其他文件中定义。</p>
</li>
<li><p><code>synthesize.c</code>从用户处获取一系列音符，写入文件。<br>get_string 获取一系列音符直至 EOF ，分辨作为休止符的空行。<br>使用 strtok() 匹配str note 和str duration （分数）。<br>使用 note_write 写入文件。</p>
</li>
<li><p><code>wav.h</code> 是 notes.c 和 synthesize.c 中都会使用到的头文件。<br>定义了结构体 note 和 song 。<br>定义了 note_write, rest_write, song_close, 以及 song_open 函数。</p>
</li>
<li><p><code>wav.c</code></p>
</li>
<li><p><code>Makefiles</code>是 make命令编译时配置文件，编译 notes 和 synthesize 涉及多个文件。</p>
</li>
<li><p><code>helpers.h</code> 定义<code>duration</code>,<code>frequency</code> 和 <code>is_rest</code>函数。</p>
</li>
<li><p><code>helpters.c</code></p>
</li>
</ol>
<h2 id="Specification"><a href="#Specification" class="headerlink" title="Specification"></a>Specification</h2><ol>
<li>经过读谱，在<code>bday.txt</code>中写入机器可读取的内容</li>
<li>在 cs50.h 中找到 get_string 上的注释，发现<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * Prompts user for a line of text from standard input and returns</span><br><span class="line"> * it as a string (char *), sans trailing line ending. Supports</span><br><span class="line"> * CR (\r), LF (\n), and CRLF (\r\n) as line endings. If user</span><br><span class="line"> * inputs only a line ending, returns &quot;&quot;, not NULL. Returns NULL</span><br><span class="line"> * upon error or no input whatsoever (i.e., just EOF). Stores string</span><br><span class="line"> * on heap, but library&#39;s destructor frees memory on program&#39;s exit.</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure>
也就是说 get_string 方法读取空行时，得到的是“”而非NULL。而 EOF 时得到的是 NULL。</li>
</ol>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ol>
<li>补全 duration 函数，得到谱面音符的相对时值（1/8）</li>
<li>频率计算<br>按照获取的string note（如A#4）<br>得到 octave = 4<br>name（与标准音的半音差） = 0<br>half = +1<br>得到<br><code>output = 440 * ( 2 ^ ( ( name + half ) / 12 ) ) * (2 ^ ( octave - 4 ) );</code></li>
<li>进行小的单元测试，按照功能进行调试，然后进行下一步。<br>特别是在调整模拟频率上，分别按照音高、半音、音阶进行调整。</li>
<li>最后，注意精度(round)和类型转换！</li>
</ol>
<h2 id="Code-Solution"><a href="#Code-Solution" class="headerlink" title="Code Solution"></a>Code Solution</h2><figure class="highlight c"><figcaption><span>helpers.c []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Converts a fraction formatted as X/Y to eighths</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">duration</span><span class="params">(<span class="built_in">string</span> fraction)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> X = strtok(fraction, <span class="string">"/"</span>);</span><br><span class="line">    <span class="keyword">int</span> x = atoi(X);</span><br><span class="line">    <span class="built_in">string</span> Y = strtok(<span class="literal">NULL</span>, <span class="string">"/"</span>);</span><br><span class="line">    <span class="keyword">int</span> y = atoi(Y);</span><br><span class="line">    <span class="keyword">int</span> output = x * <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">3</span> - log2(y)) ;</span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calculates frequency (in Hz) of a note</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">frequency</span><span class="params">(<span class="built_in">string</span> note)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// set octave to store how to */ 2</span></span><br><span class="line">    <span class="comment">// set half to store whether or not should * 2 ^ 1/12</span></span><br><span class="line">    <span class="comment">// set hame to store how much it relate to A</span></span><br><span class="line">    <span class="keyword">int</span> octave = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">int</span> half = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> name = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// if the note is semi like A#4</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(note) == <span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//get octave on A#4,minus char '4'</span></span><br><span class="line">        octave = note[<span class="number">2</span>] - <span class="string">'4'</span>;</span><br><span class="line">        <span class="comment">// set half = 1 if #</span></span><br><span class="line">        <span class="keyword">if</span> (note[<span class="number">1</span>] == <span class="string">'#'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            half = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// set half = -1 if b</span></span><br><span class="line">        <span class="keyword">if</span> (note[<span class="number">1</span>] == <span class="string">'b'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            half = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// if no semi, the length of note is 2, like A4</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(note) == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//get octave</span></span><br><span class="line">        octave = note[<span class="number">1</span>] - <span class="string">'4'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// get name by char note[0]</span></span><br><span class="line">    <span class="keyword">switch</span> (note[<span class="number">0</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'C'</span>:</span><br><span class="line">            name = <span class="number">-9</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'D'</span>:</span><br><span class="line">            name = <span class="number">-7</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'E'</span>:</span><br><span class="line">            name = <span class="number">-5</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'F'</span>:</span><br><span class="line">            name = <span class="number">-4</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'G'</span>:</span><br><span class="line">            name = <span class="number">-2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'A'</span>:</span><br><span class="line">            name = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'B'</span>:</span><br><span class="line">            name = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//calculate the frequency and return the int output</span></span><br><span class="line">    <span class="keyword">int</span> freq = <span class="number">0</span>;</span><br><span class="line">    freq = round(<span class="number">440</span> * <span class="built_in">pow</span>(<span class="number">2.00</span>, (name + half) / <span class="number">12</span> + octave));</span><br><span class="line">    <span class="keyword">return</span>  freq;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Determines whether a string represents a rest</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_rest</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// if it is "" return false</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strncmp</span>(s, <span class="string">""</span>, <span class="number">1</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他 </p>
<figure class="highlight c"><figcaption><span>synthesize.c []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="built_in">string</span> argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Check command line arguments</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Usage: synthesize FILE\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">string</span> filename = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// Open file for writing</span></span><br><span class="line">    song s = song_open(filename);</span><br><span class="line">    <span class="comment">// Expect notes from user until EOF</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Expect note</span></span><br><span class="line">        <span class="built_in">string</span> <span class="built_in">line</span> = get_string(<span class="string">""</span>);</span><br><span class="line">        <span class="comment">// Check for EOF</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">line</span> == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Check if line is rest</span></span><br><span class="line">        <span class="keyword">if</span> (is_rest(<span class="built_in">line</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            rest_write(s, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Parse line into note and duration</span></span><br><span class="line">            <span class="built_in">string</span> note = strtok(<span class="built_in">line</span>, <span class="string">"@"</span>);</span><br><span class="line">            <span class="built_in">string</span> fraction = strtok(<span class="literal">NULL</span>, <span class="string">"@"</span>);</span><br><span class="line">            <span class="comment">// Write note to song</span></span><br><span class="line">            note_write(s, frequency(note), duration(fraction));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Close file</span></span><br><span class="line">    song_close(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另一个</p>
<figure class="highlight c"><figcaption><span>note.c []</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Notes in an octave</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">string</span> NOTES[] = &#123;<span class="string">"C"</span>, <span class="string">"C#"</span>, <span class="string">"D"</span>, <span class="string">"D#"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>,</span><br><span class="line">                        <span class="string">"F#"</span>, <span class="string">"G"</span>, <span class="string">"G#"</span>, <span class="string">"A"</span>, <span class="string">"A#"</span>, <span class="string">"B"</span></span><br><span class="line">                       &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Default octave</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OCTAVE 4</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="built_in">string</span> argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Override default octave if specified at command line</span></span><br><span class="line">    <span class="keyword">int</span> octave = OCTAVE;</span><br><span class="line">    <span class="keyword">if</span> (argc == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        octave = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (octave &lt; <span class="number">0</span> || octave &gt; <span class="number">8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//unvalid input actave</span></span><br><span class="line">            <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Invalid octave\n"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (argc &gt; <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//too much arguments</span></span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Usage: notes [OCTAVE]\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Open file for writing</span></span><br><span class="line">    song s = song_open(<span class="string">"notes.wav"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add each semitone</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, n = <span class="keyword">sizeof</span>(NOTES) / <span class="keyword">sizeof</span>(<span class="built_in">string</span>); i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Append octave to note</span></span><br><span class="line">        <span class="keyword">char</span> note[<span class="number">4</span>];</span><br><span class="line">        <span class="built_in">sprintf</span>(note, <span class="string">"%s%i"</span>, NOTES[i], octave);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Calculate frequency of note</span></span><br><span class="line">        <span class="keyword">int</span> f = frequency(note);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Print note to screen</span></span><br><span class="line">        <span class="comment">//as A#4:440</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%3s: %i\n"</span>, note, f);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Write (eighth) note to file</span></span><br><span class="line">        note_write(s, f, <span class="number">1</span>);<span class="comment">// note_write()</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Close file</span></span><br><span class="line">    song_close(s);<span class="comment">// song_close()</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yilin"
      src="/images/avat.JPG">
  <p class="site-author-name" itemprop="name">Yilin</p>
  <div class="site-description" itemprop="description">Thoughts. Notes.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yilin10" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yilin10" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yilin.zhu@mail.polimi.it" title="E-Mail → mailto:yilin.zhu@mail.polimi.it" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/ilin.chu0" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;ilin.chu0" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yilin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
