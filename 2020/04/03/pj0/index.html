<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="机器学习实验项目_波士顿房价预测 0. 项目背景这是一个几年之前的机器学习练习项目。数据来源是UCI的机器学习知识库数据集。该数据从1978年开始，共506个数据点，涵盖了马萨诸塞州波士顿郊区的房屋信息数据。 在此项目中，我会使用这些数据训练并测试一个可用的预测模型，并对模型的性能和预测能力进行测试。训练好的模型可以对房屋的价值进行预测，对某些工作中，应用这个模型可以帮助他们了解房屋的潜在价值，是">
<meta property="og:type" content="article">
<meta property="og:title" content="Boston housing Predictor">
<meta property="og:url" content="http://yoursite.com/2020/04/03/pj0/index.html">
<meta property="og:site_name" content="Parking Site">
<meta property="og:description" content="机器学习实验项目_波士顿房价预测 0. 项目背景这是一个几年之前的机器学习练习项目。数据来源是UCI的机器学习知识库数据集。该数据从1978年开始，共506个数据点，涵盖了马萨诸塞州波士顿郊区的房屋信息数据。 在此项目中，我会使用这些数据训练并测试一个可用的预测模型，并对模型的性能和预测能力进行测试。训练好的模型可以对房屋的价值进行预测，对某些工作中，应用这个模型可以帮助他们了解房屋的潜在价值，是">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/images/output_22_0.png">
<meta property="og:image" content="http://yoursite.com/images/output_26_0.png">
<meta property="article:published_time" content="2020-04-03T15:42:53.000Z">
<meta property="article:modified_time" content="2020-04-07T12:25:11.300Z">
<meta property="article:author" content="Yilin">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/output_22_0.png">

<link rel="canonical" href="http://yoursite.com/2020/04/03/pj0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Boston housing Predictor | Parking Site</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Parking Site</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">A castle on the cloud.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/03/pj0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avat.JPG">
      <meta itemprop="name" content="Yilin">
      <meta itemprop="description" content="Thoughts. Notes.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Parking Site">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Boston housing Predictor
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-03 15:42:53" itemprop="dateCreated datePublished" datetime="2020-04-03T15:42:53Z">2020-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-07 12:25:11" itemprop="dateModified" datetime="2020-04-07T12:25:11Z">2020-04-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Projects/" itemprop="url" rel="index"><span itemprop="name">Projects</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>机器学习实验项目_波士顿房价预测</p>
<h2 id="0-项目背景"><a href="#0-项目背景" class="headerlink" title="0. 项目背景"></a>0. 项目背景</h2><p>这是一个几年之前的机器学习练习项目。数据来源是UCI的机器学习知识库数据集。该数据从1978年开始，共506个数据点，涵盖了马萨诸塞州波士顿郊区的房屋信息数据。</p>
<p>在此项目中，我会使用这些数据训练并测试一个可用的预测模型，并对模型的性能和预测能力进行测试。训练好的模型可以对房屋的价值进行预测，对某些工作中，应用这个模型可以帮助他们了解房屋的潜在价值，是非常实用的。</p>
<p>从学习的角度来看，做这个项目则是可以初步了解机器学习的实践方法，了解如何处理数据，并熟悉 python 和 sklearn在项目中的使用。</p>
<blockquote>
<p><strong>提示：</strong>Code 和 Markdown 区域可通过 <strong>Shift + Enter</strong> 快捷键运行。此外，Markdown可以通过双击进入编辑模式。</p>
</blockquote>
<hr>
<h2 id="1-导入数据"><a href="#1-导入数据" class="headerlink" title="1. 导入数据"></a>1. 导入数据</h2><p>本项目的数据集来自<a href="https://archive.ics.uci.edu/ml/datasets.html" target="_blank" rel="noopener">UCI机器学习知识库(数据集已下线)</a>。<br>可以看到，波士顿房屋这些数据于1978年开始统计，共506个数据点，涵盖了麻省波士顿不同郊区房屋14种特征的信息。<br>在此，首先我将针对本项目对原始数据集做以下处理：观察数据 -&gt; 移除异常值 -&gt; 思考哪些是和目标相关的特征。<br>具体处理如下：</p>
<ul>
<li>有16个<code>&#39;MEDV&#39;</code> 值为50.0的数据点被移除。 因为这些数据点包含遗失或者不明确的数值。</li>
<li>有1个数据点的 <code>&#39;RM&#39;</code> 值为8.78. 这是一个异常值，已经被移除。</li>
<li>对于本项目，房屋的<code>&#39;RM&#39;</code>， <code>&#39;LSTAT&#39;</code>，<code>&#39;PTRATIO&#39;</code>以及<code>&#39;MEDV&#39;</code>特征是必要的，其余不相关特征已经被移除。</li>
<li><code>&#39;MEDV&#39;</code>特征的值已经过必要的数学转换，可以反映35年来市场的通货膨胀效应。</li>
</ul>
<p>运行下面区域的代码后，我就可以载入波士顿房屋数据集，以及一些此项目所需的Python库。<br>我会从 csv 文件中读取到需要的数值，如果成功返回数据集的大小，则表示数据集已载入成功。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> visuals <span class="keyword">as</span> vs <span class="comment"># import supplement</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># check Python version </span></span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> version_info</span><br><span class="line"><span class="keyword">if</span> version_info.major != <span class="number">2</span> <span class="keyword">and</span> version_info.minor != <span class="number">7</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">'Please use Python 2.7'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># show result in notebook</span></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 载入波士顿房屋的数据集</span></span><br><span class="line">data = pd.read_csv(<span class="string">'housing.csv'</span>)</span><br><span class="line">prices = data[<span class="string">'MEDV'</span>]</span><br><span class="line">features = data.drop(<span class="string">'MEDV'</span>, axis = <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 完成</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Boston housing dataset has &#123;&#125; data points with &#123;&#125; variables each."</span>.format(*data.shape)</span><br></pre></td></tr></table></figure>

<pre><code>Boston housing dataset has 489 data points with 4 variables each.</code></pre><hr>
<h2 id="2-分析数据"><a href="#2-分析数据" class="headerlink" title="2. 分析数据"></a>2. 分析数据</h2><p>我需要继续观察目前得到的数据，以便在后续阶段能够理解对数据进行分析后得到的结果或对结果进行分析。</p>
<p>由于我的最终目标是将实现一个表现良好的房屋价值预估的模型，所以我依然需要把完整的数据集分成<strong>feature</strong>和<strong>target</strong>。</p>
<ul>
<li><strong>特征</strong>： <code>&#39;RM&#39;</code>， <code>&#39;LSTAT&#39;</code>，和 <code>&#39;PTRATIO&#39;</code></li>
<li><strong>目标变量</strong>：<code>&#39;MEDV&#39;</code>，是我希望预测的变量。</li>
</ul>
<p>我用 <code>features</code>和<code>prices</code>两个变量进行存储。</p>
<h3 id="2-1-基础统计运算"><a href="#2-1-基础统计运算" class="headerlink" title="2.1 基础统计运算"></a>2.1 基础统计运算</h3><p>我导入了<code>numpy</code> 执行计算。这些统计数据对于分析模型的预测结果非常重要的。</p>
<ul>
<li>计算<code>prices</code>中的<code>&#39;MEDV&#39;</code>的最小值、最大值、均值、中值和标准差；</li>
<li>将运算结果储存在相应的变量中。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的最小值</span></span><br><span class="line">minimum_price = np.min(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的最大值</span></span><br><span class="line">maximum_price = np.max(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的平均值</span></span><br><span class="line">mean_price = np.mean(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的中值</span></span><br><span class="line">median_price = np.median(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：计算价值的标准差</span></span><br><span class="line">std_price = np.std(prices)</span><br><span class="line"></span><br><span class="line"><span class="comment">#目标：输出计算的结果</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Statistics for Boston housing dataset:\n"</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Minimum price: $&#123;:,.2f&#125;"</span>.format(minimum_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Maximum price: $&#123;:,.2f&#125;"</span>.format(maximum_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Mean price: $&#123;:,.2f&#125;"</span>.format(mean_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Median price $&#123;:,.2f&#125;"</span>.format(median_price)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Standard deviation of prices: $&#123;:,.2f&#125;"</span>.format(std_price)</span><br></pre></td></tr></table></figure>

<pre><code>Statistics for Boston housing dataset:

Minimum price: $105,000.00
Maximum price: $1,024,800.00
Mean price: $454,342.94
Median price $438,900.00
Standard deviation of prices: $165,171.13</code></pre><h3 id="2-2-特征观察"><a href="#2-2-特征观察" class="headerlink" title="2.2 特征观察"></a>2.2 特征观察</h3><p>如前文所述，本项目中我们关注的是其中三个值:<code>&#39;RM&#39;</code>、<code>&#39;LSTAT&#39;</code> 和<code>&#39;PTRATIO&#39;</code>，对每一个数据点:</p>
<ul>
<li><code>&#39;RM&#39;</code> 是该地区中每个房屋的平均房间数量；</li>
<li><code>&#39;LSTAT&#39;</code> 是指该地区有多少百分比的业主属于是低收入阶层（有工作但收入微薄）；</li>
<li><code>&#39;PTRATIO&#39;</code> 是该地区的中学和小学里，学生和老师的数目比（<code>学生/老师</code>）。</li>
</ul>
<p><em>凭直觉，上述三个特征中对每一个来说，你认为增大该特征的数值，<code>&#39;MEDV&#39;</code>的值会是<strong>增大</strong>还是<strong>减小</strong>呢？</em></p>
<ul>
<li>RM 变大，MEDV 越大，因为房间多整体空间更大</li>
<li>LSTAT 越大，MEDV 越小，因为代表着当地经济价值比较低</li>
<li>PTRATIO 越大，MEDV 越低，因为该地区学生多教师少，教育价值降低了</li>
</ul>
<h3 id="2-2-数据分割与重排"><a href="#2-2-数据分割与重排" class="headerlink" title="2.2 数据分割与重排"></a>2.2 数据分割与重排</h3><p>接下来，我需要把波士顿房屋数据集分成训练和测试两个子集。<br>通常在这个过程中，数据也会被重排列，以消除数据集中由于顺序而产生的偏差。</p>
<p>我使用 <code>sklearn.model_selection</code> 中的 <code>train_test_split</code>， 将<code>features</code>和<code>prices</code>的数据都分成用于训练的数据子集和用于测试的数据子集。</p>
<ul>
<li>分割比例为：80%的数据用于训练，20%用于测试；</li>
<li>选定一个数值以设定 <code>train_test_split</code> 中的 <code>random_state</code> ，这会确保结果的一致性；</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提示： 导入train_test_split</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(features, prices, test_size=<span class="number">0.2</span>, random_state=<span class="number">22</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-训练及测试"><a href="#2-3-训练及测试" class="headerlink" title="2.3 训练及测试"></a>2.3 训练及测试</h3><p><em>将数据集按一定比例分为训练用的数据集和测试用的数据集对学习算法有什么好处？</em></p>
<p><em>如果用模型已经见过的数据，例如部分训练集数据进行测试，又有什么坏处？</em> 如果没有数据来对模型进行测试，会出现什么问题？</p>
<ul>
<li>将数据集按照一定比例分割，我们可以合理评估学习算法在面对未知数据时的表现效果</li>
<li>用来评价模型的数据如果不是独立于样本的，则可能评价结果是不准确的情况。我们也无法得出，这个算法是否可以应用在更广泛的情况</li>
</ul>
<hr>
<h2 id="3-模型衡量标准"><a href="#3-模型衡量标准" class="headerlink" title="3. 模型衡量标准"></a>3. 模型衡量标准</h2><p>在项目的第三步中，你需要了解必要的工具和技巧来让你的模型进行预测。用这些工具和技巧对每一个模型的表现做精确的衡量可以极大地增强你预测的信心。</p>
<h3 id="3-1-定义衡量标准"><a href="#3-1-定义衡量标准" class="headerlink" title="3.1 定义衡量标准"></a>3.1 定义衡量标准</h3><p>如果不能对模型的训练和测试的表现进行量化地评估，就很难衡量模型的好坏。一般情况下，我们可以定义一些衡量标准，这些标准可以通过对某些误差或者拟合程度的计算来得到。在这个项目中，你将通过运算<a href="http://stattrek.com/statistics/dictionary.aspx?definition=coefficient_of_determination" target="_blank" rel="noopener"><em>决定系数</em></a> R<sup>2</sup> 来量化模型的表现。模型的决定系数是回归分析中十分常用的统计信息，经常被当作衡量模型预测能力好坏的标准。</p>
<p>R<sup>2</sup>的数值范围从0至1，表示<strong>目标变量</strong>的预测值和实际值之间的相关程度平方的百分比。一个模型的R<sup>2</sup> 值为0还不如直接用<strong>平均值</strong>来预测效果好；而一个R<sup>2</sup> 值为1的模型则可以对目标变量进行完美的预测。从0至1之间的数值，则表示该模型中目标变量中有百分之多少能够用<strong>特征</strong>来解释。<em>模型也可能出现负值的R<sup>2</sup>，这种情况下模型所做预测有时会比直接计算目标变量的平均值差很多。</em></p>
<p>在下方代码的 <code>performance_metric</code> 函数中，我实现了：</p>
<ul>
<li>使用 <code>sklearn.metrics</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.r2_score.html" target="_blank" rel="noopener"><code>r2_score</code></a> 来计算 <code>y_true</code> 和 <code>y_predict</code>的R<sup>2</sup>值，作为对其表现的评判。</li>
<li>将他们的表现评分储存到<code>score</code>变量中。</li>
</ul>
<p>或（:这个并没有实现:）</p>
<ul>
<li>(可选) 不使用任何外部库，参考<a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" target="_blank" rel="noopener">决定系数的定义</a>进行计算，这也可以帮助你更好的理解决定系数在什么情况下等于0或等于1。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入r2_score</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance_metric</span><span class="params">(y_true, y_predict)</span>:</span></span><br><span class="line">    <span class="string">"""计算并返回预测值相比于预测值的分数"""</span></span><br><span class="line">    </span><br><span class="line">    score = r2_score(y_true, y_predict)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不导入任何计算决定系数的库</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">performance_metric2</span><span class="params">(y_true, y_predict)</span>:</span></span><br><span class="line">    <span class="string">"""计算并返回预测值相比于预测值的分数"""</span></span><br><span class="line">    </span><br><span class="line">    score = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>

<h3 id="3-2-拟合程度"><a href="#3-2-拟合程度" class="headerlink" title="3.2 拟合程度"></a>3.2 拟合程度</h3><p>假设一个数据集有五个数据且一个模型做出下列目标变量的预测：</p>
<table>
<thead>
<tr>
<th align="center">真实数值</th>
<th align="center">预测数值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3.0</td>
<td align="center">2.5</td>
</tr>
<tr>
<td align="center">-0.5</td>
<td align="center">0.0</td>
</tr>
<tr>
<td align="center">2.0</td>
<td align="center">2.1</td>
</tr>
<tr>
<td align="center">7.0</td>
<td align="center">7.8</td>
</tr>
<tr>
<td align="center">4.2</td>
<td align="center">5.3</td>
</tr>
</tbody></table>
<p><em>怎么样可以判断，这个模型已成功地描述了目标变量的变化？</em>  </p>
<p>通过运行下方的代码，我可以使用<code>performance_metric</code>函数来计算模型的决定系数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算这个模型的预测结果的决定系数</span></span><br><span class="line">score = performance_metric([<span class="number">3</span>, <span class="number">-0.5</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4.2</span>], [<span class="number">2.5</span>, <span class="number">0.0</span>, <span class="number">2.1</span>, <span class="number">7.8</span>, <span class="number">5.3</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">"Model has a coefficient of determination, R^2, of &#123;:.3f&#125;."</span>.format(score)</span><br></pre></td></tr></table></figure>

<pre><code>Model has a coefficient of determination, R^2, of 0.923.</code></pre><ul>
<li>这个模型以及较为成功地描述了目标变量的变化。</li>
<li>因为可以看到 R^2 计算结果为 0.923 意味着数据超过90的部分能够使用模型进行特征的描述和预测</li>
</ul>
<hr>
<h2 id="4-分析模型的表现"><a href="#4-分析模型的表现" class="headerlink" title="4. 分析模型的表现"></a>4. 分析模型的表现</h2><p>在项目的第四步，可以来看一下不同参数下，模型在训练集和验证集上的表现。<br>我只是用了一个特定的算法（带剪枝的决策树），在参数选择上，这个算法只包括了选择参数 <code>&#39;max_depth&#39;</code>。<br>我会用全部训练集训练，但选择不同<code>&#39;max_depth&#39;</code> 参数，观察这个参数的变化如何影响模型的表现。<br>最后，画出模型的表现来对于分析过程十分有益，这可以让我直观地看到模型的表现。</p>
<h3 id="4-1-学习曲线"><a href="#4-1-学习曲线" class="headerlink" title="4.1 学习曲线"></a>4.1 学习曲线</h3><ul>
<li>下方区域内的代码可以输出四幅图像，他们分别表现了一个决策树模型在不同最大深度下的表现。</li>
<li>每一条曲线都直观得显示了随着训练数据量的增加，模型学习曲线的在训练集评分和验证集评分的变化。</li>
<li>评分使用决定系数R<sup>2</sup>。曲线的阴影区域代表的是该曲线的不确定性（用标准差衡量）。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据不同的训练集大小，和最大深度，生成学习曲线</span></span><br><span class="line">vs.ModelLearning(X_train, y_train)</span><br></pre></td></tr></table></figure>


<p><img src="/images/output_22_0.png" alt="png"></p>
<h3 id="4-2-对学习曲线的观察"><a href="#4-2-对学习曲线的观察" class="headerlink" title="4.2 对学习曲线的观察"></a>4.2 对学习曲线的观察</h3><p>所以从上面的图形中，我应该怎么决定合适的最大深度呢？</p>
<p>其次，随着寻来拿数据量的增加，训练集曲线的评分正在发生变化，验证集曲线也有变化。我也需要考虑数据继续增加的情况下，如何保持或者有效提升模型的表现呢？但是学习曲线看上去最终都很稳定，是不是会最终收敛到一个特定的值。</p>
<ul>
<li>我想选择 max = 3，也就是将深度设定为3.</li>
<li>从曲线的观察上来看，随着训练数据量的增加，训练集曲线评分降低了一点，但趋于稳定。</li>
<li>随着训练数据量的增加，验证集曲线迅速上升后也趋于稳定</li>
<li>如果有更多训练数据，且新训练数据分布和现有相同，模型的表现不会有什么明显提升，因为现在已经能够捕捉数据的全部特征了。</li>
</ul>
<h3 id="4-3-复杂度曲线"><a href="#4-3-复杂度曲线" class="headerlink" title="4.3 复杂度曲线"></a>4.3 复杂度曲线</h3><p>下列代码内的区域会输出一幅图像，用于展示了一个已经经过训练和验证的决策树模型在不同最大深度条件下的表现。</p>
<p>这个图形将包含两条曲线，一个是训练集的变化，一个是验证集的变化。跟<strong>学习曲线</strong>相似，阴影区域代表该曲线的不确定性，模型训练和测试部分的评分都用的 <code>performance_metric</code> 函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据不同的最大深度参数，生成复杂度曲线</span></span><br><span class="line">vs.ModelComplexity(X_train, y_train)</span><br></pre></td></tr></table></figure>


<p><img src="/images/output_26_0.png" alt="png"></p>
<h3 id="4-4-偏差（bias）与方差（variance）之间的权衡取舍"><a href="#4-4-偏差（bias）与方差（variance）之间的权衡取舍" class="headerlink" title="4.4 偏差（bias）与方差（variance）之间的权衡取舍"></a>4.4 偏差（bias）与方差（variance）之间的权衡取舍</h3><p><em>当模型以最大深度 1训练时，模型的预测是出现很大的偏差还是出现了很大的方差？当模型以最大深度10训练时，情形又如何呢？图形中的哪些特征能够支持你的结论？</em></p>
<p> 我要如何判断模型是否出现了偏差很大或者方差很大的问题？</p>
<ul>
<li>模型深度为 1 时，偏差大。</li>
<li>因为可以看到模型预测在训练集上的得分低，说明模型预测不准确。</li>
<li>而当模型深度为 10 时，方差大。</li>
<li>可以看到模型预测在训练集上的得分高，接近1，说明预测准确。但模型在训练集上表现较好，但测试集上表现差，说明面对新数据时表现不好。</li>
</ul>
<h3 id="4-5-最优模型的猜测"><a href="#4-5-最优模型的猜测" class="headerlink" title="4.5 最优模型的猜测"></a>4.5 最优模型的猜测</h3><p>我应该选择哪一个最大深度，才能对未来（未知）的数据进行预测。</p>
<ul>
<li>按照图 5 来看可以选择深度为 6 的模型。</li>
<li>个人认为，深度为 4 时，方差最小，但偏差仅仅超过0.8。</li>
<li>随着深度增加，偏差仍在迅速缩小，而在 6 之后，偏差开始趋于稳定，处在0.9左右。</li>
<li>此时方差看上去增大了0.1左右，可以接受。</li>
</ul>
<hr>
<h2 id="5-选择最优参数"><a href="#5-选择最优参数" class="headerlink" title="5. 选择最优参数"></a>5. 选择最优参数</h2><h3 id="5-1-网格搜索（Grid-Search）"><a href="#5-1-网格搜索（Grid-Search）" class="headerlink" title="5.1 网格搜索（Grid Search）"></a>5.1 网格搜索（Grid Search）</h3><p><em>什么是网格搜索法？如何用它来优化模型？</em></p>
<ul>
<li>网格搜索，是一种系统地遍历多种参数组合，通过交叉验证确定最佳效果参数的方法</li>
<li>使用网格搜索优化模型，可以对不同参数组合进行评估，得到最合适的参数组合，优化模型</li>
</ul>
<h3 id="5-2-交叉验证"><a href="#5-2-交叉验证" class="headerlink" title="5.2 交叉验证"></a>5.2 交叉验证</h3><ul>
<li>什么是K折交叉验证法（k-fold cross-validation）？</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener">GridSearchCV</a>是如何结合交叉验证来完成对最佳参数组合的选择的？</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener">GridSearchCV</a>中的<code>&#39;cv_results_&#39;</code>属性能告诉我们什么？</li>
<li>网格搜索时如果不使用交叉验证会有什么问题？交叉验证又是如何解决这个问题的？</li>
</ul>
<p>在下面 fit_model函数最后加入 <code>print pd.DataFrame(grid.cv_results_)</code> 可以查看更多信息。</p>
<ol>
<li><p>什么是K折交叉验证法（k-fold cross-validation）？</p>
<ul>
<li>K折交叉验证，是将训练数据（验证集）平分到 k 个容器。在每次实验时，选择其中 1 个容器中的数据作为验证集，其他（k-1）个容器作为训练集。</li>
<li>继续训练模型，并进行验证。</li>
<li>交叉验证会在过程中进行 k 次实验，然后取得 k 次实验测试结果的平均值。</li>
</ul>
</li>
<li><p>网格搜索如何结合交叉验证完成最佳参数选择？</p>
<ul>
<li>这种方法中我们对每 1 个参数组合进行 1 次 K 折较差验证，得到平均分数。</li>
<li>一般选择均分最高的参数组合作为最优参数，但如果品分标准是loss，会选择评分最低的参数组合。</li>
</ul>
</li>
<li><p>cv_results_属性代表什么？</p>
<ul>
<li>cv_results_可以用来来获得最优参数组合</li>
<li>它返回了一个字典，其中记录了每一组网格参数每一次实验时的结果，如时间、评估值、其他统计信息</li>
</ul>
</li>
<li><p>网格搜索时如果不使用交叉验证会有什么问题？交叉验证又是如何解决这个问题的？</p>
<ul>
<li>网格搜索不使用交叉验证时所花费的训练时间更短，但模型参数并不是最优；</li>
<li>交叉验证进行更多次的试验，使用了全部训练集，能够对每一个参数组合得出更准确的评分。</li>
</ul>
</li>
</ol>
<h3 id="5-3-决策树算法"><a href="#5-3-决策树算法" class="headerlink" title="5.3 决策树算法"></a>5.3 决策树算法</h3><p>下面，我会使用<strong>决策树算法</strong>训练一个模型。</p>
<p>为了得出的是一个最优模型，我需要使用网格搜索法训练模型，以找到最佳的 <code>&#39;max_depth&#39;</code> 参数。我可以把<code>&#39;max_depth&#39;</code> 参数理解为决策树算法在做出预测前，可以允许的对数据提出问题的数量。而决策树也是<strong>监督学习算法</strong>中的一种。</p>
<p>在下方 <code>fit_model</code> 函数中，我进行了如下的定义：</p>
<ol>
<li><strong>定义 <code>&#39;cross_validator&#39;</code> 变量</strong>: 使用 <code>sklearn.model_selection</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" target="_blank" rel="noopener"><code>KFold</code></a> 创建一个交叉验证生成器对象;</li>
<li><strong>定义 <code>&#39;regressor&#39;</code> 变量</strong>: 使用  <code>sklearn.tree</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html" target="_blank" rel="noopener"><code>DecisionTreeRegressor</code></a> 创建一个决策树的回归函数;</li>
<li><strong>定义 <code>&#39;params&#39;</code> 变量</strong>: 为 <code>&#39;max_depth&#39;</code> 参数创造一个字典，它的值是从1至10的数组;</li>
<li><strong>定义 <code>&#39;scoring_fnc&#39;</code> 变量</strong>: 使用 <code>sklearn.metrics</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html" target="_blank" rel="noopener"><code>make_scorer</code></a>  创建一个评分函数；<br>将 <code>‘performance_metric’</code> 作为参数传至这个函数中；</li>
<li><strong>定义 <code>&#39;grid&#39;</code> 变量</strong>: 使用 <code>sklearn.model_selection</code> 中的 <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" target="_blank" rel="noopener"><code>GridSearchCV</code></a> 创建一个网格搜索对象；将变量<code>&#39;regressor&#39;</code>, <code>&#39;params&#39;</code>, <code>&#39;scoring_fnc&#39;</code>和 <code>&#39;cross_validator&#39;</code> 作为参数传至这个对象构造函数中；</li>
</ol>
<p>关于python函数的默认参数定义和传递，可以参考的资料是，这个MIT课程的<a href="http://cn-static.udacity.com/mlnd/videos/MIT600XXT114-V004200_DTH.mp4" target="_blank" rel="noopener">视频</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提示: 导入 'KFold' 'DecisionTreeRegressor' 'make_scorer' 'GridSearchCV' </span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold,GridSearchCV</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> make_scorer</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_model</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">""" 基于输入数据 [X,y]，利于网格搜索找到最优的决策树模型"""</span></span><br><span class="line">    </span><br><span class="line">    cross_validator = KFold(n_splits=<span class="number">10</span>)</span><br><span class="line">    </span><br><span class="line">    regressor =  DecisionTreeRegressor()</span><br><span class="line"></span><br><span class="line">    params = &#123;<span class="string">'max_depth'</span>:range(<span class="number">1</span>,<span class="number">11</span>)&#125;</span><br><span class="line"></span><br><span class="line">    scoring_fnc = make_scorer(performance_metric)</span><br><span class="line"></span><br><span class="line">    grid = GridSearchCV(regressor, params, scoring=scoring_fnc,cv=cross_validator)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 基于输入数据 [X,y]，进行网格搜索</span></span><br><span class="line">    grid = grid.fit(X, y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回网格搜索后的最优模型</span></span><br><span class="line">    <span class="keyword">return</span> grid.best_estimator_</span><br></pre></td></tr></table></figure>

<h3 id="5-4-训练最优模型（-没有实现）"><a href="#5-4-训练最优模型（-没有实现）" class="headerlink" title="5.4 训练最优模型（*没有实现）"></a>5.4 训练最优模型（*没有实现）</h3><p>另外一种方法是在下方 <code>fit_model</code> 函数中：</p>
<ul>
<li>遍历参数<code>‘max_depth’</code>的可选值 1～10，构造对应模型</li>
<li>计算当前模型的交叉验证分数</li>
<li>返回最优交叉验证分数对应的模型</li>
</ul>
<p>但这一个方法还没有完成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Not finished!</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">不允许使用 DecisionTreeRegressor 以外的任何 sklearn 库</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">提示: 你可能需要实现下面的 cross_val_score 函数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def cross_val_score(estimator, X, y, scoring = performance_metric, cv=3):</span></span><br><span class="line"><span class="string">    """ 返回每组交叉验证的模型分数的数组 """</span></span><br><span class="line"><span class="string">    scores = [0,0,0]</span></span><br><span class="line"><span class="string">    return scores</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fit_model2</span><span class="params">(X, y)</span>:</span></span><br><span class="line">    <span class="string">""" 基于输入数据 [X,y]，利于网格搜索找到最优的决策树模型"""</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#最优交叉验证分数对应的最优模型</span></span><br><span class="line">    best_estimator = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> best_estimator</span><br></pre></td></tr></table></figure>

<h3 id="5-5-最优模型"><a href="#5-5-最优模型" class="headerlink" title="5.5 最优模型"></a>5.5 最优模型</h3><p><em>最优模型的最大深度（maximum depth）是多少？</em></p>
<p>通过下面的代码，我能够将决策树回归函数代入训练数据的集合，以得到最优化的模型。并得到最大深度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于训练数据，获得最优模型</span></span><br><span class="line">optimal_reg = fit_model(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出最优模型的 'max_depth' 参数</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Parameter 'max_depth' is &#123;&#125; for the optimal model."</span>.format(optimal_reg.get_params()[<span class="string">'max_depth'</span>])</span><br></pre></td></tr></table></figure>

<pre><code>Parameter &apos;max_depth&apos; is 4 for the optimal model.</code></pre><p>可以看到，此时的最大深度为4，和我开始目测的不同。</p>
<h2 id="6-做出预测"><a href="#6-做出预测" class="headerlink" title="6. 做出预测"></a>6. 做出预测</h2><p>当我们用数据训练出一个模型，它现在就可用于对新的数据进行预测。在决策树回归函数中，模型已经学会对新输入的数据<em>提问</em>，并返回对<strong>目标变量</strong>的预测值。你可以用这个预测来获取数据未知目标变量的信息，这些数据必须是不包含在训练数据之内的。</p>
<h3 id="6-1-预测销售价格"><a href="#6-1-预测销售价格" class="headerlink" title="6.1 预测销售价格"></a>6.1 预测销售价格</h3><p>接下来由于模型已经得到了，我需要开始应用这个模型处理一些问题。</p>
<p>假设我是一个在波士顿地区的房屋经纪人，我可以使用此模型以帮助你的客户评估他们想出售的房屋。</p>
<p>假设你已经从你的三个客户收集到以下的资讯:</p>
<table>
<thead>
<tr>
<th align="center">特征</th>
<th align="center">客戶 1</th>
<th align="center">客戶 2</th>
<th align="center">客戶 3</th>
</tr>
</thead>
<tbody><tr>
<td align="center">房屋内房间总数</td>
<td align="center">5 间房间</td>
<td align="center">4 间房间</td>
<td align="center">8 间房间</td>
</tr>
<tr>
<td align="center">社区贫困指数（％被认为是贫困阶层）</td>
<td align="center">17%</td>
<td align="center">32%</td>
<td align="center">3%</td>
</tr>
<tr>
<td align="center">邻近学校的学生-老师比例</td>
<td align="center">15：1</td>
<td align="center">22：1</td>
<td align="center">12：1</td>
</tr>
</tbody></table>
<p><em>那么接下来，我需要给每位客户的房屋销售的价格进行建议？并通过房屋特征的数值提供对于价格的合理判断。</em> </p>
<p>运行下列的代码区域，我就可以使用优化的模型来为每位客户的房屋价值做出预测。并结合我在第一步中数据分析的阶段，计算出来的部分统计信息来辅助证明我的模型是否正确。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成三个客户的数据</span></span><br><span class="line">client_data = [[<span class="number">5</span>, <span class="number">17</span>, <span class="number">15</span>], <span class="comment"># 客户 1</span></span><br><span class="line">               [<span class="number">4</span>, <span class="number">32</span>, <span class="number">22</span>], <span class="comment"># 客户 2</span></span><br><span class="line">               [<span class="number">8</span>, <span class="number">3</span>, <span class="number">12</span>]]  <span class="comment"># 客户 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行预测</span></span><br><span class="line">predicted_price = optimal_reg.predict(client_data)</span><br><span class="line"><span class="keyword">for</span> i, price <span class="keyword">in</span> enumerate(predicted_price):</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Predicted selling price for Client &#123;&#125;'s home: $&#123;:,.2f&#125;"</span>.format(i+<span class="number">1</span>, price)</span><br></pre></td></tr></table></figure>

<pre><code>Predicted selling price for Client 1&apos;s home: $409,100.00
Predicted selling price for Client 2&apos;s home: $285,600.00
Predicted selling price for Client 3&apos;s home: $957,218.18</code></pre><ul>
<li><p>预测价值为409100、285600、957218 美元。</p>
</li>
<li><p>从房屋特征来看，房屋质量的高中低档水平应该是 客户 3 （高档）&gt; 客户 1 （中档）&gt; 客户 2（低档） 。</p>
</li>
<li><p>从统计数据来看，客户 1 的房屋价值处在 Min 与 Max 之间，接近均价和中位数。客户 2 的房屋价值较低，只稍微比 Min 高一点。客户 3 的房屋价值较高，接近 Max 价格。符合房屋特征的判断，因此预测还是是比较合理的。</p>
</li>
</ul>
<h3 id="6-2-使用模型进行预测"><a href="#6-2-使用模型进行预测" class="headerlink" title="6.2 使用模型进行预测"></a>6.2 使用模型进行预测</h3><p>我对三个客户的房子的售价进行了预测。接下来，我会使用我的最优模型在整个测试数据上进行预测, 并计算相对于目标变量的决定系数 R<sup>2</sup>的值**。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 提示：你可能需要用到 X_test, y_test, optimal_reg, performance_metric</span></span><br><span class="line"><span class="comment"># 提示：你可能需要参考问题10的代码进行预测</span></span><br><span class="line"><span class="comment"># 提示：你可能需要参考问题3的代码来计算R^2的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line">r2 = r2_score(y_test, optimal_reg.predict(X_test))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"Optimal model has R^2 score &#123;:,.2f&#125; on test data"</span>.format(r2)</span><br></pre></td></tr></table></figure>

<pre><code>Optimal model has R^2 score 0.78 on test data</code></pre><h3 id="6-3-分析决定系数"><a href="#6-3-分析决定系数" class="headerlink" title="6.3 分析决定系数"></a>6.3 分析决定系数</h3><p>刚刚计算了最优模型在测试集上的决定系数，但我应该如何评价这个结果？</p>
<p>结果为 0.78 结果不算太好，但也可以进行基本的房屋价值预测了。</p>
<h3 id="6-4-模型的健壮性"><a href="#6-4-模型的健壮性" class="headerlink" title="6.4 模型的健壮性"></a>6.4 模型的健壮性</h3><p>一个最优的模型不一定是一个健壮模型。有的时候模型会过于复杂或者过于简单，以致于难以泛化新增添的数据；有的时候模型采用的学习算法并不适用于特定的数据结构；有的时候样本本身可能有太多噪点或样本过少，使得模型无法准确地预测目标变量。这些情况下我们会说模型是欠拟合的。</p>
<p>模型是否足够健壮来保证预测的一致性？</p>
<p>下面，我会采用不同的训练和测试集执行 <code>fit_model</code> 函数10次。</p>
<p>对一个特定的客户来说，预测是如何随训练数据的变化而变化的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释掉 fit_model 函数里的所有 print 语句</span></span><br><span class="line">vs.PredictTrials(features, prices, fit_model, client_data)</span><br></pre></td></tr></table></figure>

<pre><code>Trial 1: $391,183.33
Trial 2: $411,417.39
Trial 3: $415,800.00
Trial 4: $420,622.22
Trial 5: $413,334.78
Trial 6: $411,931.58
Trial 7: $399,663.16
Trial 8: $407,232.00
Trial 9: $402,531.82
Trial 10: $413,700.00

Range in prices: $29,438.89</code></pre><ul>
<li>可以从上述的结果中看到，模型还是没有太不健壮，保持了一定的稳定性。模型随着数据集的变化，最大变化差值为 29438.89 ，约为 7.5% 左右的幅度。</li>
</ul>
<h3 id="6-5-结果分析"><a href="#6-5-结果分析" class="headerlink" title="6.5 结果分析"></a>6.5 结果分析</h3><p>从结果来看，我建构的模型能否在现实世界中使用?</p>
<ul>
<li>1978年所采集的数据，在已考虑通货膨胀的前提下，在今天是否仍然适用？</li>
<li>数据中呈现的特征是否足够描述一个房屋？</li>
<li>在波士顿这样的大都市采集的数据，能否应用在其它乡镇地区</li>
<li>你觉得仅仅凭房屋所在社区的环境来判断房屋价值合理吗</li>
</ul>
<p>不同时代经济发展状况不同，人们的经济观念也不同，房屋价值的模型会随之改变。因此会在今天并不适用。<br>数据中呈现的数据还是比较简化的，没有包括房屋的采光、房体结构、社区成熟度、交通便利性等因素。<br>波士顿城市数据，应该不能应用在乡镇地区。一级城市、二级城市、偏远乡村的整体房屋价值均值相差肯定很大，会让数据集呈现异常，影响模型对特征的判断。<br>不合理，社区环境还不够全面</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/01/hello-world/" rel="prev" title="Hello World">
      <i class="fa fa-chevron-left"></i> Hello World
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/04/super/" rel="next" title="Intro to Supervised Learning Notes">
      Intro to Supervised Learning Notes <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0-项目背景"><span class="nav-number">1.</span> <span class="nav-text">0. 项目背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-导入数据"><span class="nav-number">2.</span> <span class="nav-text">1. 导入数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-分析数据"><span class="nav-number">3.</span> <span class="nav-text">2. 分析数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-基础统计运算"><span class="nav-number">3.1.</span> <span class="nav-text">2.1 基础统计运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-特征观察"><span class="nav-number">3.2.</span> <span class="nav-text">2.2 特征观察</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-数据分割与重排"><span class="nav-number">3.3.</span> <span class="nav-text">2.2 数据分割与重排</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-训练及测试"><span class="nav-number">3.4.</span> <span class="nav-text">2.3 训练及测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-模型衡量标准"><span class="nav-number">4.</span> <span class="nav-text">3. 模型衡量标准</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-定义衡量标准"><span class="nav-number">4.1.</span> <span class="nav-text">3.1 定义衡量标准</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-拟合程度"><span class="nav-number">4.2.</span> <span class="nav-text">3.2 拟合程度</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-分析模型的表现"><span class="nav-number">5.</span> <span class="nav-text">4. 分析模型的表现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-学习曲线"><span class="nav-number">5.1.</span> <span class="nav-text">4.1 学习曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-对学习曲线的观察"><span class="nav-number">5.2.</span> <span class="nav-text">4.2 对学习曲线的观察</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-复杂度曲线"><span class="nav-number">5.3.</span> <span class="nav-text">4.3 复杂度曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-偏差（bias）与方差（variance）之间的权衡取舍"><span class="nav-number">5.4.</span> <span class="nav-text">4.4 偏差（bias）与方差（variance）之间的权衡取舍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-最优模型的猜测"><span class="nav-number">5.5.</span> <span class="nav-text">4.5 最优模型的猜测</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-选择最优参数"><span class="nav-number">6.</span> <span class="nav-text">5. 选择最优参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-网格搜索（Grid-Search）"><span class="nav-number">6.1.</span> <span class="nav-text">5.1 网格搜索（Grid Search）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-交叉验证"><span class="nav-number">6.2.</span> <span class="nav-text">5.2 交叉验证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-决策树算法"><span class="nav-number">6.3.</span> <span class="nav-text">5.3 决策树算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-训练最优模型（-没有实现）"><span class="nav-number">6.4.</span> <span class="nav-text">5.4 训练最优模型（*没有实现）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-5-最优模型"><span class="nav-number">6.5.</span> <span class="nav-text">5.5 最优模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-做出预测"><span class="nav-number">7.</span> <span class="nav-text">6. 做出预测</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-预测销售价格"><span class="nav-number">7.1.</span> <span class="nav-text">6.1 预测销售价格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-使用模型进行预测"><span class="nav-number">7.2.</span> <span class="nav-text">6.2 使用模型进行预测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-分析决定系数"><span class="nav-number">7.3.</span> <span class="nav-text">6.3 分析决定系数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-模型的健壮性"><span class="nav-number">7.4.</span> <span class="nav-text">6.4 模型的健壮性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5-结果分析"><span class="nav-number">7.5.</span> <span class="nav-text">6.5 结果分析</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yilin"
      src="/images/avat.JPG">
  <p class="site-author-name" itemprop="name">Yilin</p>
  <div class="site-description" itemprop="description">Thoughts. Notes.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yilin10" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yilin10" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yilin.zhu@mail.polimi.it" title="E-Mail → mailto:yilin.zhu@mail.polimi.it" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/ilin.chu0" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;ilin.chu0" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yilin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
